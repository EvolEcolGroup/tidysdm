<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tidysdm">
<title>tidysdm overview • tidysdm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tidysdm overview">
<meta property="og:description" content="tidysdm">
<meta property="og:image" content="https://evolecolgroup.github.io/tidysdm/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tidysdm</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.9.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a0_tidysdm_overview.html">tidysdm overview</a>
    <a class="dropdown-item" href="../articles/a1_palaeodata_application.html">Application with palaeodata</a>
    <a class="dropdown-item" href="../articles/a2_tidymodels_additions.html">Examples of additional tidymodels features</a>
    <a class="dropdown-item" href="../articles/a3_troubleshooting.html">Troubleshooting models that fail</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/EvolEcolGroup/tidysdm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>tidysdm overview</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EvolEcolGroup/tidysdm/blob/HEAD/vignettes/a0_tidysdm_overview.Rmd" class="external-link"><code>vignettes/a0_tidysdm_overview.Rmd</code></a></small>
      <div class="d-none name"><code>a0_tidysdm_overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="sdms-with-tidymodels">SDMs with <code>tidymodels</code><a class="anchor" aria-label="anchor" href="#sdms-with-tidymodels"></a>
</h2>
<p>Species Distribution Modelling relies on several algorithms, many of
which have a number of hyperparameters that require turning. The
<code>tidymodels</code> universe includes a number of packages
specifically design to fit, tune and validate models. The advantage of
<code>tidymodels</code> is that the models syntax and the results
returned to the users are standardised, thus providing a coherent
interface to modelling. Given the variety of models required for SDM,
<code>tidymodels</code> is an ideal framework. <code>tidysdm</code>
provides a number of wrappers and specialised functions to facilitate
the fitting of SDM with <code>tidymodels</code>.</p>
<p>This article provides an overview of the how <code>tidysdm</code>
facilitates fitting SDMs. Further articles, detailing how to use the
package for palaeodata, fitting more complex models and how to
troubleshoot models can be found on the <a href="https://evolecolgroup.github.io/tidysdm/"><code>tidisdm</code>
website</a>. As <code>tidysdm</code> relies on <code>tidymodels</code>,
users are advised to familiarise themselves with the introductory
tutorials on the <a href="https://www.tidymodels.org/start/" class="external-link"><code>tidymodels</code>
website</a>.</p>
<p>When we load <code>tidysdm</code>, it automatically loads
<code>tidymodels</code> and all associated packages necessary to fit
models:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EvolEcolGroup/tidysdm" class="external-link">tidysdm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: tidymodels</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ────────────────────────────────────── tidymodels 1.2.0 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">broom       </span> 1.0.6      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">recipes     </span> 1.0.10</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dials       </span> 1.2.1      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">rsample     </span> 1.2.1 </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr       </span> 1.1.4      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble      </span> 3.2.1 </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">ggplot2     </span> 3.5.1      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tidyr       </span> 1.3.1 </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">infer       </span> 1.0.7      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tune        </span> 1.2.1 </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">modeldata   </span> 1.3.0      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflows   </span> 1.1.4 </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">parsnip     </span> 1.2.1      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">workflowsets</span> 1.1.0 </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">purrr       </span> 1.0.2      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">yardstick   </span> 1.3.1</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ───────────────────────────────────────── tidymodels_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">purrr</span>::<span style="color: #00BB00;">discard()</span> masks <span style="color: #0000BB;">scales</span>::discard()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span>  masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>     masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">recipes</span>::<span style="color: #00BB00;">step()</span>  masks <span style="color: #0000BB;">stats</span>::step()</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">•</span> Learn how to get started at <span style="color: #00BB00;">https://www.tidymodels.org/start/</span></span></span>
<span><span class="co">#&gt; Loading required package: spatialsample</span></span></code></pre></div>
<div class="section level4">
<h4 id="accessing-the-data-for-this-vignette-how-to-use-rgbif">Accessing the data for this vignette: how to use
<code>rgbif</code><a class="anchor" aria-label="anchor" href="#accessing-the-data-for-this-vignette-how-to-use-rgbif"></a>
</h4>
<p>We start by reading in a set of presences for a species of lizard
that inhabits the Iberian peninsula, <em>Lacerta schreiberi</em>. This
data is taken from GBIF Occurrence Download (6 July 2023) <a href="https://doi.org/10.15468/dl.srq3b3" class="external-link uri">https://doi.org/10.15468/dl.srq3b3</a>. The dataset is
already included in the <code>tidysdm</code> package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">lacerta</span><span class="op">)</span></span>
<span> <span class="va">lacerta</span></span>
<span><span class="co">#&gt;              ID latitude longitude</span></span>
<span><span class="co">#&gt; 1     858029749 42.57386 -7.093272</span></span>
<span><span class="co">#&gt; 2     858029738 42.57386 -7.093272</span></span>
<span><span class="co">#&gt; 3     614631090 41.36433 -7.901420</span></span>
<span><span class="co">#&gt; 4     614631085 41.33614 -7.806970</span></span>
<span><span class="co">#&gt; 5     614631083 41.33599 -7.808340</span></span>
<span><span class="co">#&gt; 6     614631080 41.38818 -7.830690</span></span>
<span><span class="co">#&gt; 7     614631072 41.37781 -7.813690</span></span>
<span><span class="co">#&gt; 8     614559731 40.34988 -7.702352</span></span>
<span><span class="co">#&gt; 9     614559728 40.38260 -7.701418</span></span>
<span><span class="co">#&gt; 10    614559657 40.35550 -7.558990</span></span>
<span><span class="co">#&gt; 11    614559646 40.29421 -7.650721</span></span>
<span><span class="co">#&gt; 12    614559638 40.31025 -7.750595</span></span>
<span><span class="co">#&gt; 13    614559626 40.30913 -7.754499</span></span>
<span><span class="co">#&gt; 14    614559614 40.30823 -7.755680</span></span>
<span><span class="co">#&gt; 15    614559580 40.36137 -7.652468</span></span>
<span><span class="co">#&gt; 16    614559536 40.32880 -7.675835</span></span>
<span><span class="co">#&gt; 17    614559494 40.32503 -7.683771</span></span>
<span><span class="co">#&gt; 18    614559485 40.32780 -7.677855</span></span>
<span><span class="co">#&gt; 19   4138510168 42.02203 -8.128677</span></span>
<span><span class="co">#&gt; 20   4138300594 41.99143 -8.268817</span></span>
<span><span class="co">#&gt; 21   4137774808 41.59728 -8.736125</span></span>
<span><span class="co">#&gt; 22   4137647526 41.28201 -8.731018</span></span>
<span><span class="co">#&gt; 23   4137647525 41.82842 -7.917928</span></span>
<span><span class="co">#&gt; 24   4134139940 40.69223 -8.162669</span></span>
<span><span class="co">#&gt; 25   4133852702 40.06937 -8.268567</span></span>
<span><span class="co">#&gt; 26   4121487317 41.68082 -7.713207</span></span>
<span><span class="co">#&gt; 27   4121307904 41.88402 -8.252778</span></span>
<span><span class="co">#&gt; 28   4121184631 40.84378 -7.726580</span></span>
<span><span class="co">#&gt; 29   4121124321 41.09547 -8.488889</span></span>
<span><span class="co">#&gt; 30   4116626006 42.04772 -8.503785</span></span>
<span><span class="co">#&gt; 31   4116285362 40.85782 -8.281194</span></span>
<span><span class="co">#&gt; 32   4116236838 40.66703 -7.900817</span></span>
<span><span class="co">#&gt; 33   4116092213 41.61971 -8.087063</span></span>
<span><span class="co">#&gt; 34   4112181181 41.70629 -8.096636</span></span>
<span><span class="co">#&gt; 35   4112023856 40.89950 -8.236026</span></span>
<span><span class="co">#&gt; 36   4111883952 41.63347 -7.574793</span></span>
<span><span class="co">#&gt; 37   4111614197 40.32288 -7.602690</span></span>
<span><span class="co">#&gt; 38   4103336935 40.08139 -8.204578</span></span>
<span><span class="co">#&gt; 39   4103238233 40.09843 -8.235022</span></span>
<span><span class="co">#&gt; 40   4102652095 41.87182 -8.208900</span></span>
<span><span class="co">#&gt; 41   4102603846 40.92872 -8.257428</span></span>
<span><span class="co">#&gt; 42   4102587117 41.86692 -8.216805</span></span>
<span><span class="co">#&gt; 43   4097012311 40.76552 -8.156668</span></span>
<span><span class="co">#&gt; 44   4096983593 40.92807 -8.258583</span></span>
<span><span class="co">#&gt; 45   4096753776 40.92810 -8.258452</span></span>
<span><span class="co">#&gt; 46   4080894369 40.37558 -8.368415</span></span>
<span><span class="co">#&gt; 47   4080783334 41.88167 -8.694533</span></span>
<span><span class="co">#&gt; 48   4076368267 40.63692 -8.439818</span></span>
<span><span class="co">#&gt; 49   4076093306 40.15494 -8.220965</span></span>
<span><span class="co">#&gt; 50   4076035760 40.76200 -8.553856</span></span>
<span><span class="co">#&gt; 51   4058226968 40.39995 -7.588924</span></span>
<span><span class="co">#&gt; 52   4058037946 40.40788 -7.562885</span></span>
<span><span class="co">#&gt; 53   4057914333 40.29825 -7.767162</span></span>
<span><span class="co">#&gt; 54   4056787598 43.40633 -5.339476</span></span>
<span><span class="co">#&gt; 55   4056745747 41.76657 -8.642622</span></span>
<span><span class="co">#&gt; 56   4056481420 40.40565 -7.891960</span></span>
<span><span class="co">#&gt; 57   4056306431 37.33848 -8.572752</span></span>
<span><span class="co">#&gt; 58   4046414634 40.84864 -8.382517</span></span>
<span><span class="co">#&gt; 59   4018170017 40.84750 -8.474317</span></span>
<span><span class="co">#&gt; 60   4015144485 41.16098 -8.482696</span></span>
<span><span class="co">#&gt; 61   4014974842 41.16116 -8.482167</span></span>
<span><span class="co">#&gt; 62   4006699733 41.80984 -8.131572</span></span>
<span><span class="co">#&gt; 63   3997288194 43.25489 -8.214883</span></span>
<span><span class="co">#&gt; 64   3997172501 43.45000 -4.980000</span></span>
<span><span class="co">#&gt; 65   3997131929 43.25482 -8.214870</span></span>
<span><span class="co">#&gt; 66   3997050991 43.45000 -4.980000</span></span>
<span><span class="co">#&gt; 68   3996318299 43.31143 -8.541861</span></span>
<span><span class="co">#&gt; 69   3996029768 43.25493 -8.215063</span></span>
<span><span class="co">#&gt; 70   3995883566 43.25478 -8.214628</span></span>
<span><span class="co">#&gt; 71   3995742860 40.24523 -5.604502</span></span>
<span><span class="co">#&gt; 72   3994052177 40.40062 -7.587015</span></span>
<span><span class="co">#&gt; 73   3966586163 37.32890 -8.583760</span></span>
<span><span class="co">#&gt; 74   3947369148 40.19553 -8.236308</span></span>
<span><span class="co">#&gt; 75   3912316870 41.09898 -8.560330</span></span>
<span><span class="co">#&gt; 76   3912179831 41.31493 -8.257731</span></span>
<span><span class="co">#&gt; 77   3907446980 42.83405 -7.066258</span></span>
<span><span class="co">#&gt; 78   3907284763 43.12507 -4.880099</span></span>
<span><span class="co">#&gt; 79   3907157374 43.22843 -6.046033</span></span>
<span><span class="co">#&gt; 80   3907117102 40.34128 -5.134518</span></span>
<span><span class="co">#&gt; 81   3906896706 43.60513 -5.888642</span></span>
<span><span class="co">#&gt; 82   3906336401 40.19971 -5.742140</span></span>
<span><span class="co">#&gt; 83   3906255544 40.33909 -5.156703</span></span>
<span><span class="co">#&gt; 84   3906081395 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 85   3906018124 41.77160 -8.188200</span></span>
<span><span class="co">#&gt; 86   3905579314 42.36183 -8.549850</span></span>
<span><span class="co">#&gt; 87   3905503521 43.31927 -8.521358</span></span>
<span><span class="co">#&gt; 88   3904992758 40.30552 -5.238461</span></span>
<span><span class="co">#&gt; 89   3904847047 42.82917 -5.776468</span></span>
<span><span class="co">#&gt; 90   3904684037 43.12507 -4.880099</span></span>
<span><span class="co">#&gt; 91   3904597803 42.90586 -8.402835</span></span>
<span><span class="co">#&gt; 92   3904516076 43.40315 -4.744980</span></span>
<span><span class="co">#&gt; 93   3904369429 43.22844 -6.046053</span></span>
<span><span class="co">#&gt; 94   3904282757 43.22840 -6.046134</span></span>
<span><span class="co">#&gt; 95   3903197158 40.08107 -8.203597</span></span>
<span><span class="co">#&gt; 96   3902606076 41.57694 -7.982271</span></span>
<span><span class="co">#&gt; 97   3902601687 41.16419 -8.482072</span></span>
<span><span class="co">#&gt; 98   3902423737 40.67403 -8.214256</span></span>
<span><span class="co">#&gt; 99   3902372729 41.25738 -7.935210</span></span>
<span><span class="co">#&gt; 100  3888804754 40.37550 -8.365012</span></span>
<span><span class="co">#&gt; 101  3873365684 40.37473 -8.365758</span></span>
<span><span class="co">#&gt; 102  3860741206 40.89950 -8.235959</span></span>
<span><span class="co">#&gt; 103  3860517442 41.28359 -7.838244</span></span>
<span><span class="co">#&gt; 104  3860325381 41.73333 -8.160636</span></span>
<span><span class="co">#&gt; 105  3860006479 39.87334 -8.852991</span></span>
<span><span class="co">#&gt; 106  3859664580 41.27729 -7.995230</span></span>
<span><span class="co">#&gt; 107  3859567137 40.37849 -8.371000</span></span>
<span><span class="co">#&gt; 108  3858854802 41.72320 -8.129511</span></span>
<span><span class="co">#&gt; 109  3858854034 40.35641 -7.558820</span></span>
<span><span class="co">#&gt; 110  3827447637 40.29260 -5.171154</span></span>
<span><span class="co">#&gt; 111  3827426685 40.30645 -5.190073</span></span>
<span><span class="co">#&gt; 114  3827170532 40.29279 -5.171848</span></span>
<span><span class="co">#&gt; 115  3827155357 43.25506 -8.213604</span></span>
<span><span class="co">#&gt; 116  3827120895 39.38935 -5.382989</span></span>
<span><span class="co">#&gt; 117  3826867567 43.29656 -8.554120</span></span>
<span><span class="co">#&gt; 118  3826866390 43.55284 -7.155949</span></span>
<span><span class="co">#&gt; 119  3826810234 43.10727 -6.259454</span></span>
<span><span class="co">#&gt; 120  3826711597 43.57161 -5.699182</span></span>
<span><span class="co">#&gt; 121  3826663742 43.49593 -5.934134</span></span>
<span><span class="co">#&gt; 123  3826194745 43.39108 -8.323385</span></span>
<span><span class="co">#&gt; 124  3826132575 40.35440 -5.112846</span></span>
<span><span class="co">#&gt; 125  3826103015 43.57041 -5.722249</span></span>
<span><span class="co">#&gt; 126  3826079371 43.55287 -7.155935</span></span>
<span><span class="co">#&gt; 127  3826034598 40.30568 -5.204373</span></span>
<span><span class="co">#&gt; 128  3825994248 43.55289 -7.156223</span></span>
<span><span class="co">#&gt; 129  3825834008 42.43518 -7.787696</span></span>
<span><span class="co">#&gt; 130  3825671626 42.29921 -8.427880</span></span>
<span><span class="co">#&gt; 131  3825286990 42.88293 -5.763342</span></span>
<span><span class="co">#&gt; 132  3825242818 43.11725 -6.284291</span></span>
<span><span class="co">#&gt; 133  3824773631 40.28159 -5.229868</span></span>
<span><span class="co">#&gt; 134  3824658562 42.75729 -8.272977</span></span>
<span><span class="co">#&gt; 135  3824458747 40.11800 -5.778082</span></span>
<span><span class="co">#&gt; 136  3824395901 43.60045 -5.920679</span></span>
<span><span class="co">#&gt; 138  3824325042 43.25876 -6.132585</span></span>
<span><span class="co">#&gt; 140  3824114271 43.55380 -7.150638</span></span>
<span><span class="co">#&gt; 141  3823724468 40.30637 -5.190222</span></span>
<span><span class="co">#&gt; 142  3823695876 42.04758 -7.833532</span></span>
<span><span class="co">#&gt; 143  3823679192 43.16100 -7.811129</span></span>
<span><span class="co">#&gt; 144  3823644579 43.22112 -8.282746</span></span>
<span><span class="co">#&gt; 145  3823558122 43.57641 -5.990616</span></span>
<span><span class="co">#&gt; 146  3823525379 42.43281 -8.395458</span></span>
<span><span class="co">#&gt; 147  3823405779 43.25557 -8.215127</span></span>
<span><span class="co">#&gt; 148  3823370594 40.30734 -5.190725</span></span>
<span><span class="co">#&gt; 149  3823352692 43.26045 -7.489225</span></span>
<span><span class="co">#&gt; 150  3823006585 43.25548 -8.215295</span></span>
<span><span class="co">#&gt; 151  3822784961 42.07946 -7.761854</span></span>
<span><span class="co">#&gt; 152  3822665898 42.90595 -5.805009</span></span>
<span><span class="co">#&gt; 153  3802554684 40.35618 -7.558206</span></span>
<span><span class="co">#&gt; 154  3802446032 41.31493 -8.257731</span></span>
<span><span class="co">#&gt; 155  3785165345 41.09905 -8.559851</span></span>
<span><span class="co">#&gt; 156  3785030262 40.44248 -7.515020</span></span>
<span><span class="co">#&gt; 157  3784779955 41.19607 -8.161694</span></span>
<span><span class="co">#&gt; 158  3773639035 42.00592 -8.166519</span></span>
<span><span class="co">#&gt; 159  3773638868 40.92789 -8.259287</span></span>
<span><span class="co">#&gt; 160  3773600023 40.32829 -7.586550</span></span>
<span><span class="co">#&gt; 161  3773579360 41.46367 -8.397842</span></span>
<span><span class="co">#&gt; 162  3773331266 41.46369 -8.397868</span></span>
<span><span class="co">#&gt; 163  3772430861 41.20036 -8.680263</span></span>
<span><span class="co">#&gt; 164  3764501931 41.28115 -8.730330</span></span>
<span><span class="co">#&gt; 165  3764237964 37.30751 -8.575900</span></span>
<span><span class="co">#&gt; 166  3760331840 40.66485 -7.906360</span></span>
<span><span class="co">#&gt; 167  3760256841 40.66477 -7.906402</span></span>
<span><span class="co">#&gt; 168  3760245302 41.80926 -8.132585</span></span>
<span><span class="co">#&gt; 169  3759917005 40.93054 -8.246717</span></span>
<span><span class="co">#&gt; 171  3759664475 41.28517 -8.340068</span></span>
<span><span class="co">#&gt; 172  3759511079 40.11704 -8.497478</span></span>
<span><span class="co">#&gt; 173  3759285347 41.31493 -8.257731</span></span>
<span><span class="co">#&gt; 174  3747177530 41.29057 -8.235037</span></span>
<span><span class="co">#&gt; 175  3747105785 41.82141 -8.295183</span></span>
<span><span class="co">#&gt; 176  3742983478 40.01487 -8.587528</span></span>
<span><span class="co">#&gt; 177  3733279230 43.54593 -8.046426</span></span>
<span><span class="co">#&gt; 178  3732795612 42.12000 -6.770000</span></span>
<span><span class="co">#&gt; 179  3732784603 43.38732 -4.323388</span></span>
<span><span class="co">#&gt; 180  3732557326 43.28899 -6.771403</span></span>
<span><span class="co">#&gt; 181  3732423322 42.43443 -7.704437</span></span>
<span><span class="co">#&gt; 182  3732260894 40.26377 -5.268384</span></span>
<span><span class="co">#&gt; 183  3731723971 43.73630 -7.703093</span></span>
<span><span class="co">#&gt; 186  3731246742 40.27246 -5.234587</span></span>
<span><span class="co">#&gt; 187  3731140171 40.27177 -5.246742</span></span>
<span><span class="co">#&gt; 188  3730867547 43.57594 -5.992134</span></span>
<span><span class="co">#&gt; 189  3730795274 43.57253 -5.994503</span></span>
<span><span class="co">#&gt; 190  3730747451 43.40228 -8.327387</span></span>
<span><span class="co">#&gt; 191  3730259342 43.30598 -8.536074</span></span>
<span><span class="co">#&gt; 192  3729886329 43.28944 -8.489956</span></span>
<span><span class="co">#&gt; 193  3729533373 43.30155 -8.503598</span></span>
<span><span class="co">#&gt; 194  3729338522 40.35877 -5.526905</span></span>
<span><span class="co">#&gt; 195  3729243652 43.59940 -5.939154</span></span>
<span><span class="co">#&gt; 196  3729232715 43.30372 -8.428818</span></span>
<span><span class="co">#&gt; 197  3729072329 40.34943 -5.295884</span></span>
<span><span class="co">#&gt; 198  3728708629 42.92490 -8.169698</span></span>
<span><span class="co">#&gt; 199  3728646722 40.27644 -5.231343</span></span>
<span><span class="co">#&gt; 200  3728584484 40.27056 -5.238148</span></span>
<span><span class="co">#&gt; 201  3728498330 43.10000 -6.270000</span></span>
<span><span class="co">#&gt; 202  3728484592 43.30411 -8.606538</span></span>
<span><span class="co">#&gt; 203  3728404536 40.21742 -7.732143</span></span>
<span><span class="co">#&gt; 204  3728122900 43.25263 -6.728374</span></span>
<span><span class="co">#&gt; 205  3728027283 40.29539 -5.173345</span></span>
<span><span class="co">#&gt; 206  3727992574 40.29203 -5.171374</span></span>
<span><span class="co">#&gt; 207  3727770407 43.04447 -6.251601</span></span>
<span><span class="co">#&gt; 208  3727675314 43.28323 -8.545810</span></span>
<span><span class="co">#&gt; 209  3727241475 40.34139 -5.186852</span></span>
<span><span class="co">#&gt; 210  3726885606 42.11812 -6.714393</span></span>
<span><span class="co">#&gt; 211  3726351000 42.03855 -6.887438</span></span>
<span><span class="co">#&gt; 212  3726280229 43.10000 -6.270000</span></span>
<span><span class="co">#&gt; 213  3726168466 43.15211 -5.600696</span></span>
<span><span class="co">#&gt; 214  3726010635 43.10000 -4.060000</span></span>
<span><span class="co">#&gt; 215  3725698669 43.13044 -4.809709</span></span>
<span><span class="co">#&gt; 216  3725422827 42.44063 -6.394794</span></span>
<span><span class="co">#&gt; 219  3725093673 40.42682 -6.149007</span></span>
<span><span class="co">#&gt; 220  3725060873 43.15699 -6.952821</span></span>
<span><span class="co">#&gt; 222  3722268573 43.55432 -6.111816</span></span>
<span><span class="co">#&gt; 224  3721736481 43.47930 -7.913536</span></span>
<span><span class="co">#&gt; 225  3721494769 43.29768 -8.570078</span></span>
<span><span class="co">#&gt; 226  3721392112 40.27242 -5.234640</span></span>
<span><span class="co">#&gt; 227  3721022126 40.51314 -6.167968</span></span>
<span><span class="co">#&gt; 228  3720913817 43.30505 -8.535715</span></span>
<span><span class="co">#&gt; 229  3720828362 43.48000 -7.050000</span></span>
<span><span class="co">#&gt; 230  3720765384 43.08638 -9.192246</span></span>
<span><span class="co">#&gt; 231  3720759073 43.44339 -5.791692</span></span>
<span><span class="co">#&gt; 232  3720503132 40.51314 -6.167968</span></span>
<span><span class="co">#&gt; 233  3720484714 43.55238 -6.014103</span></span>
<span><span class="co">#&gt; 235  3720151980 39.47717 -5.388593</span></span>
<span><span class="co">#&gt; 236  3720021627 43.13527 -4.816869</span></span>
<span><span class="co">#&gt; 237  3719941935 43.57282 -5.994296</span></span>
<span><span class="co">#&gt; 238  3719639436 43.57665 -5.990095</span></span>
<span><span class="co">#&gt; 239  3719396101 40.26263 -5.270146</span></span>
<span><span class="co">#&gt; 240  3719284704 43.28000 -5.990000</span></span>
<span><span class="co">#&gt; 241  3719224766 39.44328 -5.344995</span></span>
<span><span class="co">#&gt; 242  3719071502 40.27115 -5.235581</span></span>
<span><span class="co">#&gt; 243  3718346021 43.27167 -8.516319</span></span>
<span><span class="co">#&gt; 244  3718113343 43.10000 -6.270000</span></span>
<span><span class="co">#&gt; 245  3718042204 43.10000 -6.270000</span></span>
<span><span class="co">#&gt; 246  3717590281 43.10000 -6.270000</span></span>
<span><span class="co">#&gt; 247  3717451694 43.29755 -8.571736</span></span>
<span><span class="co">#&gt; 248  3717446813 43.29811 -8.534722</span></span>
<span><span class="co">#&gt; 249  3717173342 40.31362 -5.627051</span></span>
<span><span class="co">#&gt; 250  3716997397 42.40000 -8.490000</span></span>
<span><span class="co">#&gt; 251  3716892411 42.07009 -6.541847</span></span>
<span><span class="co">#&gt; 253  3716632135 42.07006 -6.541246</span></span>
<span><span class="co">#&gt; 254  3716268286 40.27742 -5.111580</span></span>
<span><span class="co">#&gt; 256  3715931235 43.23981 -8.901147</span></span>
<span><span class="co">#&gt; 258  3715143459 40.24000 -5.330000</span></span>
<span><span class="co">#&gt; 259  3698100690 39.31591 -7.330855</span></span>
<span><span class="co">#&gt; 260  3456534329 39.60585 -8.359525</span></span>
<span><span class="co">#&gt; 261  3415427142 41.08160 -8.471741</span></span>
<span><span class="co">#&gt; 262  3408234996 40.81437 -8.227214</span></span>
<span><span class="co">#&gt; 263  3390592007 41.81128 -8.044139</span></span>
<span><span class="co">#&gt; 264  3390592000 41.92987 -8.247404</span></span>
<span><span class="co">#&gt; 265  3390591998 41.41318 -7.846593</span></span>
<span><span class="co">#&gt; 266  3390591995 41.78309 -7.912192</span></span>
<span><span class="co">#&gt; 267  3390591971 42.00115 -8.137898</span></span>
<span><span class="co">#&gt; 268  3390591967 37.37215 -8.476313</span></span>
<span><span class="co">#&gt; 269  3390591966 41.81295 -8.272851</span></span>
<span><span class="co">#&gt; 270  3390591954 37.31002 -8.781429</span></span>
<span><span class="co">#&gt; 271  3390591946 41.65946 -8.214528</span></span>
<span><span class="co">#&gt; 272  3390591940 41.79707 -8.802613</span></span>
<span><span class="co">#&gt; 273  3390591931 41.41178 -7.715009</span></span>
<span><span class="co">#&gt; 274  3390591923 41.74814 -8.033049</span></span>
<span><span class="co">#&gt; 275  3390591909 41.29657 -7.896422</span></span>
<span><span class="co">#&gt; 276  3390591908 42.03769 -8.209891</span></span>
<span><span class="co">#&gt; 277  3390591902 41.86966 -6.525084</span></span>
<span><span class="co">#&gt; 278  3390591891 37.63410 -8.621811</span></span>
<span><span class="co">#&gt; 279  3390591866 37.35397 -8.442567</span></span>
<span><span class="co">#&gt; 280  3390591865 41.32324 -7.860128</span></span>
<span><span class="co">#&gt; 281  3390591864 41.91170 -8.223503</span></span>
<span><span class="co">#&gt; 282  3390591861 40.90137 -8.021737</span></span>
<span><span class="co">#&gt; 283  3390591856 41.93926 -8.307606</span></span>
<span><span class="co">#&gt; 284  3390591855 37.82380 -8.791282</span></span>
<span><span class="co">#&gt; 285  3390591848 41.78436 -8.056572</span></span>
<span><span class="co">#&gt; 286  3390591824 41.81945 -7.947697</span></span>
<span><span class="co">#&gt; 287  3390591815 41.85524 -7.923018</span></span>
<span><span class="co">#&gt; 288  3390591813 41.92319 -6.957134</span></span>
<span><span class="co">#&gt; 289  3390591805 41.76881 -8.429748</span></span>
<span><span class="co">#&gt; 290  3390591793 42.00124 -8.149971</span></span>
<span><span class="co">#&gt; 291  3390591787 41.76683 -8.116979</span></span>
<span><span class="co">#&gt; 292  3390591786 41.50183 -7.713232</span></span>
<span><span class="co">#&gt; 293  3390591783 41.74017 -8.165445</span></span>
<span><span class="co">#&gt; 294  3390591775 41.76674 -8.104951</span></span>
<span><span class="co">#&gt; 295  3390591774 41.88515 -8.296138</span></span>
<span><span class="co">#&gt; 296  3390591766 41.93966 -6.872173</span></span>
<span><span class="co">#&gt; 297  3390591765 41.84890 -8.260399</span></span>
<span><span class="co">#&gt; 298  3390591763 41.81022 -7.923772</span></span>
<span><span class="co">#&gt; 299  3390591761 41.90338 -8.332106</span></span>
<span><span class="co">#&gt; 300  3390591747 41.93197 -6.944793</span></span>
<span><span class="co">#&gt; 301  3390591745 41.81922 -7.923621</span></span>
<span><span class="co">#&gt; 302  3390591734 41.77685 -8.261227</span></span>
<span><span class="co">#&gt; 303  3390591720 41.81213 -8.152474</span></span>
<span><span class="co">#&gt; 304  3390591718 41.94841 -8.331636</span></span>
<span><span class="co">#&gt; 305  3390591710 41.92404 -7.005345</span></span>
<span><span class="co">#&gt; 306  3390591705 37.42686 -8.645462</span></span>
<span><span class="co">#&gt; 307  3390591681 41.76615 -8.032778</span></span>
<span><span class="co">#&gt; 308  3390591680 40.85867 -8.354572</span></span>
<span><span class="co">#&gt; 309  3390591679 41.79385 -8.116609</span></span>
<span><span class="co">#&gt; 310  3390591665 39.34446 -7.359429</span></span>
<span><span class="co">#&gt; 311  3390591654 41.77628 -8.177010</span></span>
<span><span class="co">#&gt; 312  3390591642 42.02817 -8.137533</span></span>
<span><span class="co">#&gt; 313  3390591632 41.78502 -8.140797</span></span>
<span><span class="co">#&gt; 314  3390591631 41.93447 -7.089449</span></span>
<span><span class="co">#&gt; 315  3390591625 41.80165 -7.972062</span></span>
<span><span class="co">#&gt; 316  3390591614 41.92705 -7.897690</span></span>
<span><span class="co">#&gt; 317  3390591611 41.80143 -7.947992</span></span>
<span><span class="co">#&gt; 318  3390591594 41.34952 -7.787951</span></span>
<span><span class="co">#&gt; 319  3390591593 41.87560 -8.211889</span></span>
<span><span class="co">#&gt; 320  3390591590 37.40887 -8.656846</span></span>
<span><span class="co">#&gt; 321  3390591586 40.98243 -8.020540</span></span>
<span><span class="co">#&gt; 322  3390591581 41.69460 -8.093934</span></span>
<span><span class="co">#&gt; 323  3390591574 41.75745 -8.068994</span></span>
<span><span class="co">#&gt; 324  3390591566 41.95712 -8.283281</span></span>
<span><span class="co">#&gt; 325  3390591555 41.77442 -7.948433</span></span>
<span><span class="co">#&gt; 326  3390591548 41.95775 -8.391870</span></span>
<span><span class="co">#&gt; 327  3390591547 41.36753 -7.787617</span></span>
<span><span class="co">#&gt; 328  3390591546 41.81087 -7.995991</span></span>
<span><span class="co">#&gt; 329  3390591535 41.85579 -7.983243</span></span>
<span><span class="co">#&gt; 330  3390591529 41.84646 -7.947255</span></span>
<span><span class="co">#&gt; 331  3390591521 41.84699 -8.007472</span></span>
<span><span class="co">#&gt; 332  3390591513 41.67739 -8.202297</span></span>
<span><span class="co">#&gt; 333  3390591507 41.96613 -8.283180</span></span>
<span><span class="co">#&gt; 334  3390591490 41.86642 -8.187904</span></span>
<span><span class="co">#&gt; 335  3390591486 42.02826 -8.149611</span></span>
<span><span class="co">#&gt; 336  3390591482 41.97498 -8.258943</span></span>
<span><span class="co">#&gt; 337  3390591474 41.70449 -8.213981</span></span>
<span><span class="co">#&gt; 338  3390591461 39.29008 -7.337507</span></span>
<span><span class="co">#&gt; 339  3390591422 41.74918 -8.165329</span></span>
<span><span class="co">#&gt; 340  3390591411 41.88026 -7.079013</span></span>
<span><span class="co">#&gt; 341  3390591410 41.71192 -8.009551</span></span>
<span><span class="co">#&gt; 342  3390591403 41.79265 -7.972206</span></span>
<span><span class="co">#&gt; 343  3390591393 41.89377 -8.235774</span></span>
<span><span class="co">#&gt; 344  3390591374 42.01016 -8.137777</span></span>
<span><span class="co">#&gt; 345  3390591372 39.29926 -7.348887</span></span>
<span><span class="co">#&gt; 346  3390591366 41.72250 -8.213761</span></span>
<span><span class="co">#&gt; 347  3390591343 42.00167 -8.210336</span></span>
<span><span class="co">#&gt; 348  3390591323 41.88886 -7.054650</span></span>
<span><span class="co">#&gt; 349  3390591318 41.91036 -6.752582</span></span>
<span><span class="co">#&gt; 350  3390591315 41.75725 -8.044940</span></span>
<span><span class="co">#&gt; 351  3390591312 41.75782 -8.117103</span></span>
<span><span class="co">#&gt; 352  3390591306 41.93986 -8.416165</span></span>
<span><span class="co">#&gt; 353  3390591295 41.26835 -7.777515</span></span>
<span><span class="co">#&gt; 354  3390591291 41.82919 -8.031831</span></span>
<span><span class="co">#&gt; 355  3390591283 41.92297 -6.945082</span></span>
<span><span class="co">#&gt; 356  3390591267 41.92929 -6.800157</span></span>
<span><span class="co">#&gt; 357  3390591254 40.80315 -8.129872</span></span>
<span><span class="co">#&gt; 358  3390591245 41.34077 -7.812017</span></span>
<span><span class="co">#&gt; 359  3390591231 41.77453 -7.960463</span></span>
<span><span class="co">#&gt; 360  3390591221 41.92995 -8.259464</span></span>
<span><span class="co">#&gt; 361  3390591219 41.79243 -7.948139</span></span>
<span><span class="co">#&gt; 362  3390591208 41.77602 -8.140917</span></span>
<span><span class="co">#&gt; 363  3390591205 41.83745 -7.947403</span></span>
<span><span class="co">#&gt; 364  3390591203 41.91805 -7.897845</span></span>
<span><span class="co">#&gt; 365  3390591199 41.88477 -8.235881</span></span>
<span><span class="co">#&gt; 366  3390591191 37.34516 -8.487790</span></span>
<span><span class="co">#&gt; 367  3390591167 41.93986 -8.416165</span></span>
<span><span class="co">#&gt; 368  3390591125 41.37654 -7.787450</span></span>
<span><span class="co">#&gt; 369  3390591119 41.97440 -8.174466</span></span>
<span><span class="co">#&gt; 370  3390591118 37.31886 -8.702402</span></span>
<span><span class="co">#&gt; 371  3390591116 41.81911 -7.911583</span></span>
<span><span class="co">#&gt; 372  3390591111 41.32382 -7.919859</span></span>
<span><span class="co">#&gt; 373  3390591108 41.79394 -8.128643</span></span>
<span><span class="co">#&gt; 374  3390591086 41.91793 -7.885789</span></span>
<span><span class="co">#&gt; 375  3390591085 41.85590 -7.995288</span></span>
<span><span class="co">#&gt; 376  3390591082 41.87347 -7.946812</span></span>
<span><span class="co">#&gt; 377  3390591080 41.75673 -7.984807</span></span>
<span><span class="co">#&gt; 378  3390591079 41.94204 -7.004784</span></span>
<span><span class="co">#&gt; 379  3390591076 41.83767 -7.971486</span></span>
<span><span class="co">#&gt; 380  3390591065 40.94556 -7.926045</span></span>
<span><span class="co">#&gt; 381  3390591060 41.72171 -8.105575</span></span>
<span><span class="co">#&gt; 382  3390591051 42.07328 -8.149011</span></span>
<span><span class="co">#&gt; 383  3390591043 41.81044 -7.947845</span></span>
<span><span class="co">#&gt; 384  3390591036 41.86480 -7.983100</span></span>
<span><span class="co">#&gt; 385  3390591035 41.72180 -8.117596</span></span>
<span><span class="co">#&gt; 386  3390591031 41.67801 -8.298398</span></span>
<span><span class="co">#&gt; 387  3390591011 41.91816 -7.909902</span></span>
<span><span class="co">#&gt; 388  3390591002 41.82122 -8.164394</span></span>
<span><span class="co">#&gt; 389  3390590999 41.67763 -8.238334</span></span>
<span><span class="co">#&gt; 390  3390590995 41.94747 -8.186877</span></span>
<span><span class="co">#&gt; 391  3390590988 41.69548 -8.214090</span></span>
<span><span class="co">#&gt; 392  3390590986 41.94367 -7.101237</span></span>
<span><span class="co">#&gt; 393  3390590978 41.97506 -8.271011</span></span>
<span><span class="co">#&gt; 394  3390590977 41.75801 -8.141157</span></span>
<span><span class="co">#&gt; 395  3390590976 42.01934 -8.161808</span></span>
<span><span class="co">#&gt; 396  3390590973 41.93261 -6.980956</span></span>
<span><span class="co">#&gt; 397  3390590959 41.83974 -8.236417</span></span>
<span><span class="co">#&gt; 398  3390590956 41.91545 -7.029728</span></span>
<span><span class="co">#&gt; 399  3390590947 41.78586 -8.261123</span></span>
<span><span class="co">#&gt; 400  3390590946 41.82823 -7.923470</span></span>
<span><span class="co">#&gt; 401  3390590942 41.87358 -7.958860</span></span>
<span><span class="co">#&gt; 402  3390590935 41.80237 -8.056308</span></span>
<span><span class="co">#&gt; 403  3390590924 37.34531 -8.521658</span></span>
<span><span class="co">#&gt; 404  3390590910 40.95510 -7.985299</span></span>
<span><span class="co">#&gt; 405  3390590909 41.89826 -7.078474</span></span>
<span><span class="co">#&gt; 406  3390590903 37.42683 -8.634159</span></span>
<span><span class="co">#&gt; 407  3390590890 41.83799 -8.007611</span></span>
<span><span class="co">#&gt; 408  3390590889 41.90004 -7.898155</span></span>
<span><span class="co">#&gt; 409  3390590874 41.88529 -8.320242</span></span>
<span><span class="co">#&gt; 410  3390590870 41.73151 -8.213652</span></span>
<span><span class="co">#&gt; 411  3390590867 42.07337 -8.161097</span></span>
<span><span class="co">#&gt; 412  3390590864 41.75773 -8.105076</span></span>
<span><span class="co">#&gt; 413  3390590860 41.48300 -7.641741</span></span>
<span><span class="co">#&gt; 414  3390590859 41.68648 -8.214200</span></span>
<span><span class="co">#&gt; 415  3390590840 41.92159 -8.368094</span></span>
<span><span class="co">#&gt; 416  3390590838 41.96635 -8.319381</span></span>
<span><span class="co">#&gt; 417  3390590831 41.74909 -8.153303</span></span>
<span><span class="co">#&gt; 418  3390590821 41.83065 -8.224482</span></span>
<span><span class="co">#&gt; 419  3390590819 41.82196 -8.272749</span></span>
<span><span class="co">#&gt; 420  3390590815 41.83949 -8.200288</span></span>
<span><span class="co">#&gt; 421  3390590813 41.89430 -8.320146</span></span>
<span><span class="co">#&gt; 422  3390590787 41.90331 -8.320051</span></span>
<span><span class="co">#&gt; 423  3390590784 41.89992 -7.886102</span></span>
<span><span class="co">#&gt; 424  3390590783 41.70415 -8.165911</span></span>
<span><span class="co">#&gt; 425  3390590778 42.04627 -8.149371</span></span>
<span><span class="co">#&gt; 426  3390590762 41.83689 -7.887196</span></span>
<span><span class="co">#&gt; 427  3390590760 41.98341 -8.174350</span></span>
<span><span class="co">#&gt; 428  3390590759 41.85547 -7.947107</span></span>
<span><span class="co">#&gt; 429  3390590756 41.73099 -8.141517</span></span>
<span><span class="co">#&gt; 430  3390590755 41.34965 -7.799902</span></span>
<span><span class="co">#&gt; 431  3390590749 42.04644 -8.173534</span></span>
<span><span class="co">#&gt; 432  3390590743 41.41243 -7.774819</span></span>
<span><span class="co">#&gt; 433  3390590737 41.49296 -7.725386</span></span>
<span><span class="co">#&gt; 434  3390590736 41.93880 -8.235237</span></span>
<span><span class="co">#&gt; 435  3390590732 39.30875 -7.383459</span></span>
<span><span class="co">#&gt; 436  3390590722 41.71212 -8.033588</span></span>
<span><span class="co">#&gt; 437  3390590697 41.83756 -7.959444</span></span>
<span><span class="co">#&gt; 438  3390590696 37.50798 -8.645079</span></span>
<span><span class="co">#&gt; 439  3390590688 41.81204 -8.140437</span></span>
<span><span class="co">#&gt; 440  3390590680 41.76541 -7.948580</span></span>
<span><span class="co">#&gt; 441  3390590679 41.78331 -7.936255</span></span>
<span><span class="co">#&gt; 442  3390590664 41.70312 -8.033723</span></span>
<span><span class="co">#&gt; 443  3390590662 41.94788 -8.247192</span></span>
<span><span class="co">#&gt; 444  3390590653 41.95720 -8.295346</span></span>
<span><span class="co">#&gt; 445  3390590652 41.75852 -8.213322</span></span>
<span><span class="co">#&gt; 446  3390590647 41.42024 -7.666979</span></span>
<span><span class="co">#&gt; 447  3390590623 41.84833 -8.176088</span></span>
<span><span class="co">#&gt; 448  3390590621 41.24362 -8.016652</span></span>
<span><span class="co">#&gt; 449  3390590617 41.98391 -8.246768</span></span>
<span><span class="co">#&gt; 450  3390590613 41.94854 -8.355764</span></span>
<span><span class="co">#&gt; 451  3390590611 41.67786 -8.274373</span></span>
<span><span class="co">#&gt; 452  3390590583 41.24219 -7.861537</span></span>
<span><span class="co">#&gt; 453  3390590580 41.99233 -8.162162</span></span>
<span><span class="co">#&gt; 454  3390590576 41.74026 -8.177469</span></span>
<span><span class="co">#&gt; 455  3390590573 41.88452 -8.199727</span></span>
<span><span class="co">#&gt; 456  3390590562 41.99267 -8.210448</span></span>
<span><span class="co">#&gt; 457  3390590559 41.87302 -7.898619</span></span>
<span><span class="co">#&gt; 458  3390590556 41.95734 -8.319477</span></span>
<span><span class="co">#&gt; 459  3390590552 37.33655 -8.589445</span></span>
<span><span class="co">#&gt; 460  3390590546 41.51149 -7.772954</span></span>
<span><span class="co">#&gt; 461  3390590545 41.98383 -8.234699</span></span>
<span><span class="co">#&gt; 462  3390590531 37.82378 -8.779920</span></span>
<span><span class="co">#&gt; 463  3390590528 37.66117 -8.633012</span></span>
<span><span class="co">#&gt; 464  3390590520 39.30859 -7.371864</span></span>
<span><span class="co">#&gt; 465  3390590515 41.82173 -8.236631</span></span>
<span><span class="co">#&gt; 466  3390590509 37.35461 -8.600638</span></span>
<span><span class="co">#&gt; 467  3390590498 41.98329 -6.798299</span></span>
<span><span class="co">#&gt; 468  3390590487 37.67916 -8.621582</span></span>
<span><span class="co">#&gt; 469  3390590486 42.01051 -8.186075</span></span>
<span><span class="co">#&gt; 470  3390590480 41.35914 -7.847547</span></span>
<span><span class="co">#&gt; 471  3390590476 39.31776 -7.383252</span></span>
<span><span class="co">#&gt; 472  3390590473 41.93469 -6.619057</span></span>
<span><span class="co">#&gt; 473  3390590470 41.70351 -8.081790</span></span>
<span><span class="co">#&gt; 474  3390590468 37.48996 -8.645164</span></span>
<span><span class="co">#&gt; 475  3390590462 41.70370 -8.105825</span></span>
<span><span class="co">#&gt; 476  3390590451 37.34491 -8.431345</span></span>
<span><span class="co">#&gt; 477  3390590437 41.94140 -6.968616</span></span>
<span><span class="co">#&gt; 478  3390590419 39.29909 -7.337294</span></span>
<span><span class="co">#&gt; 479  3390590417 41.80999 -7.899699</span></span>
<span><span class="co">#&gt; 480  3390590416 41.91162 -8.211447</span></span>
<span><span class="co">#&gt; 481  3390590414 41.79709 -8.814649</span></span>
<span><span class="co">#&gt; 482  3390590381 41.76645 -8.068864</span></span>
<span><span class="co">#&gt; 483  3390590371 42.07292 -8.100665</span></span>
<span><span class="co">#&gt; 484  3390590370 39.38081 -7.381799</span></span>
<span><span class="co">#&gt; 485  3390590368 41.68569 -8.106074</span></span>
<span><span class="co">#&gt; 486  3390590363 41.70332 -8.057757</span></span>
<span><span class="co">#&gt; 487  3390590351 41.81231 -8.176549</span></span>
<span><span class="co">#&gt; 488  3390590335 41.73125 -8.177584</span></span>
<span><span class="co">#&gt; 489  3390590333 41.93903 -8.271421</span></span>
<span><span class="co">#&gt; 490  3390590320 37.44508 -8.713205</span></span>
<span><span class="co">#&gt; 491  3390590317 41.76692 -8.129008</span></span>
<span><span class="co">#&gt; 492  3390590311 41.81288 -8.260813</span></span>
<span><span class="co">#&gt; 493  3390590307 41.82218 -8.308869</span></span>
<span><span class="co">#&gt; 494  3390590304 41.80266 -8.092414</span></span>
<span><span class="co">#&gt; 495  3390590303 41.85557 -7.959153</span></span>
<span><span class="co">#&gt; 496  3390590300 41.88498 -6.837833</span></span>
<span><span class="co">#&gt; 497  3390590297 41.71270 -8.105700</span></span>
<span><span class="co">#&gt; 498  3390590275 39.38900 -7.323552</span></span>
<span><span class="co">#&gt; 499  3390590263 41.80098 -7.899853</span></span>
<span><span class="co">#&gt; 500  3390590258 41.70424 -8.177928</span></span>
<span><span class="co">#&gt; 501  3390590256 41.78511 -8.152830</span></span>
<span><span class="co">#&gt; 502  3390590251 41.90904 -7.898000</span></span>
<span><span class="co">#&gt; 503  3390590228 37.31860 -8.612115</span></span>
<span><span class="co">#&gt; 504  3390590223 41.35853 -7.787784</span></span>
<span><span class="co">#&gt; 505  3390590218 41.70361 -8.093807</span></span>
<span><span class="co">#&gt; 506  3390590217 41.92694 -7.885632</span></span>
<span><span class="co">#&gt; 507  3390590208 41.51957 -7.688912</span></span>
<span><span class="co">#&gt; 508  3390590207 41.76800 -8.285389</span></span>
<span><span class="co">#&gt; 509  3390590203 40.88240 -7.915197</span></span>
<span><span class="co">#&gt; 510  3390590191 41.81118 -8.032102</span></span>
<span><span class="co">#&gt; 511  3390590186 41.68605 -8.154129</span></span>
<span><span class="co">#&gt; 512  3390590185 41.82845 -7.947550</span></span>
<span><span class="co">#&gt; 513  3390590169 41.95019 -6.956272</span></span>
<span><span class="co">#&gt; 514  3390590159 41.72198 -8.141637</span></span>
<span><span class="co">#&gt; 515  3390590151 41.49242 -7.677481</span></span>
<span><span class="co">#&gt; 516  3390590137 41.83966 -8.224374</span></span>
<span><span class="co">#&gt; 517  3390590110 41.85798 -6.838743</span></span>
<span><span class="co">#&gt; 518  3390590109 41.79438 -8.188814</span></span>
<span><span class="co">#&gt; 519  3390590102 41.94161 -6.980672</span></span>
<span><span class="co">#&gt; 520  3390590099 41.80247 -8.068343</span></span>
<span><span class="co">#&gt; 521  3390590092 41.74844 -8.069124</span></span>
<span><span class="co">#&gt; 522  3390590090 41.82019 -8.031967</span></span>
<span><span class="co">#&gt; 523  3390590082 41.77593 -8.128887</span></span>
<span><span class="co">#&gt; 524  3390590080 41.90113 -6.740851</span></span>
<span><span class="co">#&gt; 525  3390590076 41.80976 -7.875627</span></span>
<span><span class="co">#&gt; 526  3390590068 41.72993 -8.009275</span></span>
<span><span class="co">#&gt; 527  3390590064 41.98323 -8.150210</span></span>
<span><span class="co">#&gt; 528  3390590062 41.36766 -7.799571</span></span>
<span><span class="co">#&gt; 529  3390590061 41.91231 -8.319955</span></span>
<span><span class="co">#&gt; 530  3390590057 41.95040 -6.968330</span></span>
<span><span class="co">#&gt; 531  3390590042 41.00003 -7.972721</span></span>
<span><span class="co">#&gt; 532  3390590033 39.28074 -7.314540</span></span>
<span><span class="co">#&gt; 533  3390590026 41.71333 -8.189833</span></span>
<span><span class="co">#&gt; 534  3390590009 41.76664 -8.092922</span></span>
<span><span class="co">#&gt; 535  3390590008 41.89765 -7.042329</span></span>
<span><span class="co">#&gt; 536  3390590005 37.52598 -8.633677</span></span>
<span><span class="co">#&gt; 537  3390589999 41.82008 -8.019928</span></span>
<span><span class="co">#&gt; 538  3390589987 41.24320 -7.968923</span></span>
<span><span class="co">#&gt; 539  3390589980 39.27240 -7.361110</span></span>
<span><span class="co">#&gt; 540  3390589974 41.42038 -7.678942</span></span>
<span><span class="co">#&gt; 541  3390589971 41.35037 -7.871608</span></span>
<span><span class="co">#&gt; 542  3390589968 41.82140 -8.188473</span></span>
<span><span class="co">#&gt; 543  3390589950 41.25071 -7.813649</span></span>
<span><span class="co">#&gt; 544  3390589924 39.27071 -7.245228</span></span>
<span><span class="co">#&gt; 545  3390589922 41.92079 -8.235452</span></span>
<span><span class="co">#&gt; 546  3390589910 42.01034 -8.161926</span></span>
<span><span class="co">#&gt; 547  3390589905 41.80075 -7.875784</span></span>
<span><span class="co">#&gt; 548  3390589901 41.77464 -7.972493</span></span>
<span><span class="co">#&gt; 549  3390589894 41.68614 -8.166143</span></span>
<span><span class="co">#&gt; 550  3390589875 41.87551 -8.199840</span></span>
<span><span class="co">#&gt; 551  3390589860 41.73013 -8.033318</span></span>
<span><span class="co">#&gt; 552  3390589851 39.39800 -7.323337</span></span>
<span><span class="co">#&gt; 553  3390589843 41.80304 -8.140557</span></span>
<span><span class="co">#&gt; 554  3390589842 41.81899 -7.899545</span></span>
<span><span class="co">#&gt; 555  3390589838 41.92361 -6.981239</span></span>
<span><span class="co">#&gt; 556  3390589813 37.35472 -8.634512</span></span>
<span><span class="co">#&gt; 557  3390589812 41.74943 -8.201406</span></span>
<span><span class="co">#&gt; 558  3390589806 41.91194 -8.259672</span></span>
<span><span class="co">#&gt; 559  3390589803 41.71261 -8.093681</span></span>
<span><span class="co">#&gt; 560  3390589800 41.71252 -8.081662</span></span>
<span><span class="co">#&gt; 561  3390589794 41.84589 -7.887040</span></span>
<span><span class="co">#&gt; 563  3390589783 39.20817 -7.281532</span></span>
<span><span class="co">#&gt; 564  3390589780 41.81077 -7.983955</span></span>
<span><span class="co">#&gt; 565  3390589774 37.36377 -8.645760</span></span>
<span><span class="co">#&gt; 566  3390589772 41.70432 -8.189946</span></span>
<span><span class="co">#&gt; 567  3390589771 41.72982 -7.997253</span></span>
<span><span class="co">#&gt; 568  3390589754 42.05545 -8.173418</span></span>
<span><span class="co">#&gt; 569  3390589750 42.03735 -8.161571</span></span>
<span><span class="co">#&gt; 570  3390589741 41.96548 -8.186648</span></span>
<span><span class="co">#&gt; 571  3390589740 41.99299 -8.258734</span></span>
<span><span class="co">#&gt; 572  3390589717 41.99307 -8.270806</span></span>
<span><span class="co">#&gt; 573  3390589699 41.33164 -7.800233</span></span>
<span><span class="co">#&gt; 574  3390589684 41.88500 -8.272035</span></span>
<span><span class="co">#&gt; 575  3390589683 41.87293 -6.681597</span></span>
<span><span class="co">#&gt; 576  3390589680 41.47508 -7.737712</span></span>
<span><span class="co">#&gt; 577  3390589674 41.79221 -7.924073</span></span>
<span><span class="co">#&gt; 578  3390589651 41.81977 -7.983812</span></span>
<span><span class="co">#&gt; 579  3390589649 41.77574 -8.104826</span></span>
<span><span class="co">#&gt; 580  3390589648 41.84689 -7.995429</span></span>
<span><span class="co">#&gt; 581  3390589647 42.03726 -8.149491</span></span>
<span><span class="co">#&gt; 582  3390589630 41.71232 -8.057625</span></span>
<span><span class="co">#&gt; 583  3390589622 41.85806 -8.284388</span></span>
<span><span class="co">#&gt; 584  3390589617 41.82029 -8.044005</span></span>
<span><span class="co">#&gt; 585  3390589616 41.71222 -8.045607</span></span>
<span><span class="co">#&gt; 586  3390589609 42.01916 -8.137655</span></span>
<span><span class="co">#&gt; 587  3390589604 37.40006 -8.735973</span></span>
<span><span class="co">#&gt; 588  3390589599 41.37667 -7.799406</span></span>
<span><span class="co">#&gt; 589  3390589595 41.50129 -7.665320</span></span>
<span><span class="co">#&gt; 590  3390589585 41.76552 -7.960608</span></span>
<span><span class="co">#&gt; 591  3390589579 41.75818 -8.165212</span></span>
<span><span class="co">#&gt; 592  3390589569 37.39998 -8.702079</span></span>
<span><span class="co">#&gt; 593  3390589564 41.93073 -8.392126</span></span>
<span><span class="co">#&gt; 594  3390589558 41.79412 -8.152711</span></span>
<span><span class="co">#&gt; 595  3390589553 41.77611 -8.152948</span></span>
<span><span class="co">#&gt; 596  3390589541 41.70406 -8.153893</span></span>
<span><span class="co">#&gt; 597  3390589530 41.92717 -7.909749</span></span>
<span><span class="co">#&gt; 598  3390589529 41.78554 -8.212992</span></span>
<span><span class="co">#&gt; 599  3390589524 39.33561 -7.371238</span></span>
<span><span class="co">#&gt; 600  3390589523 41.87534 -8.175741</span></span>
<span><span class="co">#&gt; 601  3390589522 37.31822 -8.510545</span></span>
<span><span class="co">#&gt; 602  3390589494 41.39575 -7.906708</span></span>
<span><span class="co">#&gt; 603  3390589484 42.05562 -8.197584</span></span>
<span><span class="co">#&gt; 604  3390589483 41.73117 -8.165562</span></span>
<span><span class="co">#&gt; 605  3390589475 41.48435 -7.761488</span></span>
<span><span class="co">#&gt; 606  3390589468 37.32757 -8.600782</span></span>
<span><span class="co">#&gt; 607  3390589457 37.49879 -8.588557</span></span>
<span><span class="co">#&gt; 608  3390589454 41.49283 -7.713410</span></span>
<span><span class="co">#&gt; 609  3390589453 39.19830 -7.223871</span></span>
<span><span class="co">#&gt; 610  3390589450 41.71349 -8.213871</span></span>
<span><span class="co">#&gt; 611  3390589448 37.34544 -8.555527</span></span>
<span><span class="co">#&gt; 612  3390589441 41.76625 -8.044807</span></span>
<span><span class="co">#&gt; 613  3390589433 41.73963 -8.093302</span></span>
<span><span class="co">#&gt; 614  3390589432 41.86413 -7.910820</span></span>
<span><span class="co">#&gt; 615  3390589410 41.81499 -8.754400</span></span>
<span><span class="co">#&gt; 616  3390589408 41.95287 -7.113029</span></span>
<span><span class="co">#&gt; 617  3390589400 41.76753 -8.213212</span></span>
<span><span class="co">#&gt; 618  3390589399 41.89416 -8.296039</span></span>
<span><span class="co">#&gt; 619  3390589378 41.33225 -7.859971</span></span>
<span><span class="co">#&gt; 620  3390589375 41.76701 -8.141037</span></span>
<span><span class="co">#&gt; 621  3390589368 41.80312 -8.152593</span></span>
<span><span class="co">#&gt; 622  3390589364 41.75792 -8.129130</span></span>
<span><span class="co">#&gt; 623  3390589361 41.80257 -8.080379</span></span>
<span><span class="co">#&gt; 624  3390589360 41.74783 -7.996973</span></span>
<span><span class="co">#&gt; 625  3390589356 41.73872 -7.985090</span></span>
<span><span class="co">#&gt; 626  3390589352 41.69540 -8.202074</span></span>
<span><span class="co">#&gt; 627  3390589343 41.88191 -7.886415</span></span>
<span><span class="co">#&gt; 628  3390589331 41.88203 -7.898465</span></span>
<span><span class="co">#&gt; 629  3390589324 41.81318 -8.308965</span></span>
<span><span class="co">#&gt; 630  3390589323 41.76736 -8.189154</span></span>
<span><span class="co">#&gt; 631  3390589285 41.38567 -7.799240</span></span>
<span><span class="co">#&gt; 632  3390589279 41.73159 -8.225674</span></span>
<span><span class="co">#&gt; 633  3390589270 41.82188 -8.260710</span></span>
<span><span class="co">#&gt; 634  3390589269 39.32578 -7.313460</span></span>
<span><span class="co">#&gt; 635  3390589266 41.43958 -7.786278</span></span>
<span><span class="co">#&gt; 636  3390589262 41.34977 -7.811853</span></span>
<span><span class="co">#&gt; 637  3390589233 41.35995 -7.931217</span></span>
<span><span class="co">#&gt; 638  3390589194 41.81097 -8.008028</span></span>
<span><span class="co">#&gt; 639  3390589191 41.73090 -8.129495</span></span>
<span><span class="co">#&gt; 640  3390589189 41.32393 -7.931806</span></span>
<span><span class="co">#&gt; 641  3390589188 41.74009 -8.153421</span></span>
<span><span class="co">#&gt; 642  3390589185 41.73108 -8.153539</span></span>
<span><span class="co">#&gt; 643  3390589178 41.82899 -8.007750</span></span>
<span><span class="co">#&gt; 644  3390589175 41.97127 -7.136623</span></span>
<span><span class="co">#&gt; 645  3390589171 41.91238 -8.332012</span></span>
<span><span class="co">#&gt; 646  3390589154 41.81280 -8.248775</span></span>
<span><span class="co">#&gt; 647  3390589148 42.05527 -8.149251</span></span>
<span><span class="co">#&gt; 648  3390589144 41.69514 -8.166027</span></span>
<span><span class="co">#&gt; 649  3390589141 41.85767 -8.224156</span></span>
<span><span class="co">#&gt; 650  3390589139 41.97474 -8.222738</span></span>
<span><span class="co">#&gt; 651  3390589132 41.97563 -8.367561</span></span>
<span><span class="co">#&gt; 652  3390589125 37.76955 -8.711957</span></span>
<span><span class="co">#&gt; 653  3390589120 40.83035 -8.153236</span></span>
<span><span class="co">#&gt; 654  3390589119 41.81108 -8.020065</span></span>
<span><span class="co">#&gt; 655  3390589118 37.32793 -8.724940</span></span>
<span><span class="co">#&gt; 656  3390589117 37.34521 -8.499080</span></span>
<span><span class="co">#&gt; 657  3390589109 41.38542 -7.775326</span></span>
<span><span class="co">#&gt; 658  3390589099 42.06446 -8.173301</span></span>
<span><span class="co">#&gt; 659  3390589094 39.32709 -7.406241</span></span>
<span><span class="co">#&gt; 660  3390589087 41.35878 -7.811689</span></span>
<span><span class="co">#&gt; 661  3390589078 41.69506 -8.154011</span></span>
<span><span class="co">#&gt; 662  3390589075 42.04662 -8.197698</span></span>
<span><span class="co">#&gt; 663  3390589072 41.84905 -8.284488</span></span>
<span><span class="co">#&gt; 664  3390589068 40.99992 -7.960833</span></span>
<span><span class="co">#&gt; 665  3390589051 41.95697 -8.259151</span></span>
<span><span class="co">#&gt; 666  3390589050 41.86458 -7.959006</span></span>
<span><span class="co">#&gt; 667  3390589048 39.25321 -7.280432</span></span>
<span><span class="co">#&gt; 668  3390589042 40.89141 -7.915050</span></span>
<span><span class="co">#&gt; 669  3390589040 41.81247 -8.200624</span></span>
<span><span class="co">#&gt; 670  3390589039 41.80087 -7.887819</span></span>
<span><span class="co">#&gt; 671  3390589032 41.75810 -8.153185</span></span>
<span><span class="co">#&gt; 672  3390589030 41.72233 -8.189720</span></span>
<span><span class="co">#&gt; 673  3390589026 41.79403 -8.140677</span></span>
<span><span class="co">#&gt; 674  3390589014 41.80295 -8.128521</span></span>
<span><span class="co">#&gt; 675  3390588999 41.71324 -8.177814</span></span>
<span><span class="co">#&gt; 676  3390588996 41.92417 -6.547096</span></span>
<span><span class="co">#&gt; 677  3390588968 41.85798 -8.272342</span></span>
<span><span class="co">#&gt; 678  3390588966 41.76728 -8.177125</span></span>
<span><span class="co">#&gt; 679  3390588937 37.32745 -8.566920</span></span>
<span><span class="co">#&gt; 680  3390588932 41.89126 -7.922413</span></span>
<span><span class="co">#&gt; 681  3390588929 41.85783 -8.248249</span></span>
<span><span class="co">#&gt; 682  3390588908 41.76710 -8.153066</span></span>
<span><span class="co">#&gt; 683  3390588902 37.39989 -8.668185</span></span>
<span><span class="co">#&gt; 684  3390588896 41.78475 -8.104700</span></span>
<span><span class="co">#&gt; 685  3390588893 41.81010 -7.911735</span></span>
<span><span class="co">#&gt; 686  3390588883 41.82929 -8.043871</span></span>
<span><span class="co">#&gt; 687  3390588878 41.76777 -8.249301</span></span>
<span><span class="co">#&gt; 688  3390588876 41.85733 -8.175972</span></span>
<span><span class="co">#&gt; 689  3390588874 41.92029 -6.800467</span></span>
<span><span class="co">#&gt; 690  3390588869 41.97482 -8.234806</span></span>
<span><span class="co">#&gt; 691  3390588864 41.83111 -8.296730</span></span>
<span><span class="co">#&gt; 692  3390588860 37.31856 -8.600830</span></span>
<span><span class="co">#&gt; 693  3390588855 41.40405 -7.834791</span></span>
<span><span class="co">#&gt; 694  3390588844 41.73134 -8.189607</span></span>
<span><span class="co">#&gt; 695  3390588825 41.78343 -7.948286</span></span>
<span><span class="co">#&gt; 696  3390588823 41.93918 -8.295545</span></span>
<span><span class="co">#&gt; 697  3390588813 37.48981 -8.599918</span></span>
<span><span class="co">#&gt; 698  3390588812 42.07310 -8.124838</span></span>
<span><span class="co">#&gt; 699  3390588807 42.02861 -8.197924</span></span>
<span><span class="co">#&gt; 700  3390588802 39.32628 -7.348252</span></span>
<span><span class="co">#&gt; 701  3390588801 41.77485 -7.996553</span></span>
<span><span class="co">#&gt; 702  3390588796 42.01068 -8.210225</span></span>
<span><span class="co">#&gt; 703  3390588782 41.34101 -7.835915</span></span>
<span><span class="co">#&gt; 704  3390588776 41.92340 -6.969187</span></span>
<span><span class="co">#&gt; 705  3390588775 42.01977 -8.222190</span></span>
<span><span class="co">#&gt; 706  3390588773 41.83734 -7.935361</span></span>
<span><span class="co">#&gt; 707  3390588771 41.78520 -8.164862</span></span>
<span><span class="co">#&gt; 708  3390588763 37.30019 -8.510662</span></span>
<span><span class="co">#&gt; 709  3390588762 41.69488 -8.129980</span></span>
<span><span class="co">#&gt; 710  3390588755 41.85568 -7.971198</span></span>
<span><span class="co">#&gt; 711  3390588753 41.70388 -8.129859</span></span>
<span><span class="co">#&gt; 712  3390588750 41.99291 -8.246662</span></span>
<span><span class="co">#&gt; 713  3390588743 41.70473 -8.250034</span></span>
<span><span class="co">#&gt; 714  3390588728 41.88484 -8.247932</span></span>
<span><span class="co">#&gt; 715  3390588726 41.90769 -6.620061</span></span>
<span><span class="co">#&gt; 716  3390588723 41.26032 -7.873159</span></span>
<span><span class="co">#&gt; 717  3390588722 37.64311 -8.621765</span></span>
<span><span class="co">#&gt; 718  3390588716 41.81888 -7.887507</span></span>
<span><span class="co">#&gt; 719  3390588708 41.72207 -8.153657</span></span>
<span><span class="co">#&gt; 720  3390588690 41.93911 -8.283483</span></span>
<span><span class="co">#&gt; 721  3390588687 42.03744 -8.173651</span></span>
<span><span class="co">#&gt; 722  3390588686 41.74034 -8.189493</span></span>
<span><span class="co">#&gt; 723  3390588666 42.03680 -8.089093</span></span>
<span><span class="co">#&gt; 724  3390588662 41.80987 -7.887663</span></span>
<span><span class="co">#&gt; 725  3390588637 41.40278 -7.715187</span></span>
<span><span class="co">#&gt; 726  3390588622 41.77715 -8.309352</span></span>
<span><span class="co">#&gt; 727  3390588620 41.27856 -7.896726</span></span>
<span><span class="co">#&gt; 728  3390588611 41.86447 -7.946960</span></span>
<span><span class="co">#&gt; 729  3390588608 41.81966 -7.971774</span></span>
<span><span class="co">#&gt; 730  3390588597 41.71298 -8.141757</span></span>
<span><span class="co">#&gt; 731  3390588595 41.80276 -8.104450</span></span>
<span><span class="co">#&gt; 732  3390588589 41.94318 -6.594616</span></span>
<span><span class="co">#&gt; 733  3390588565 37.81470 -8.745863</span></span>
<span><span class="co">#&gt; 734  3390588563 37.53495 -8.622314</span></span>
<span><span class="co">#&gt; 735  3390588557 41.75715 -8.032914</span></span>
<span><span class="co">#&gt; 736  3390588534 40.66855 -8.202608</span></span>
<span><span class="co">#&gt; 737  3390588529 41.83712 -7.911278</span></span>
<span><span class="co">#&gt; 738  3390588524 41.83723 -7.923320</span></span>
<span><span class="co">#&gt; 739  3390588520 41.96483 -6.774802</span></span>
<span><span class="co">#&gt; 740  3390588517 41.78406 -8.020476</span></span>
<span><span class="co">#&gt; 741  3390588515 41.38604 -7.835113</span></span>
<span><span class="co">#&gt; 742  3390588514 37.76953 -8.700602</span></span>
<span><span class="co">#&gt; 743  3390588510 41.88006 -7.066968</span></span>
<span><span class="co">#&gt; 744  3390588503 41.72282 -8.261846</span></span>
<span><span class="co">#&gt; 745  3390588502 37.45390 -8.645334</span></span>
<span><span class="co">#&gt; 746  3390588498 41.92547 -7.089717</span></span>
<span><span class="co">#&gt; 747  3390588493 41.82180 -8.248670</span></span>
<span><span class="co">#&gt; 748  3390588487 41.80285 -8.116485</span></span>
<span><span class="co">#&gt; 749  3390588486 41.96552 -6.810978</span></span>
<span><span class="co">#&gt; 750  3390588483 41.69588 -8.274170</span></span>
<span><span class="co">#&gt; 751  3390588481 42.03761 -8.197811</span></span>
<span><span class="co">#&gt; 752  3390588479 41.99224 -8.150091</span></span>
<span><span class="co">#&gt; 753  3390588471 37.31877 -8.668544</span></span>
<span><span class="co">#&gt; 754  3390588468 41.87369 -7.970909</span></span>
<span><span class="co">#&gt; 755  3390588458 42.00133 -8.162044</span></span>
<span><span class="co">#&gt; 756  3390588451 42.02789 -8.101300</span></span>
<span><span class="co">#&gt; 757  3390588440 40.41881 -8.759554</span></span>
<span><span class="co">#&gt; 758  3390588438 41.71307 -8.153776</span></span>
<span><span class="co">#&gt; 759  3390588433 41.85775 -8.236203</span></span>
<span><span class="co">#&gt; 761  3390588430 37.27376 -8.691301</span></span>
<span><span class="co">#&gt; 762  3390588423 39.38998 -7.393199</span></span>
<span><span class="co">#&gt; 763  3390588419 41.74824 -8.045074</span></span>
<span><span class="co">#&gt; 764  3390588417 41.94874 -8.391955</span></span>
<span><span class="co">#&gt; 765  3390588416 41.81055 -7.959881</span></span>
<span><span class="co">#&gt; 766  3390588408 37.30955 -8.600878</span></span>
<span><span class="co">#&gt; 767  3390588402 41.82867 -7.971630</span></span>
<span><span class="co">#&gt; 768  3390588399 41.98332 -8.162280</span></span>
<span><span class="co">#&gt; 769  3390588396 41.72216 -8.165678</span></span>
<span><span class="co">#&gt; 770  3390588376 37.31852 -8.589544</span></span>
<span><span class="co">#&gt; 771  3390588355 37.34560 -8.600686</span></span>
<span><span class="co">#&gt; 772  3390588347 41.78465 -8.092668</span></span>
<span><span class="co">#&gt; 773  3390588343 41.38555 -7.787283</span></span>
<span><span class="co">#&gt; 774  3390588342 41.72113 -8.033453</span></span>
<span><span class="co">#&gt; 775  3390588340 41.26944 -7.884941</span></span>
<span><span class="co">#&gt; 776  3390588324 41.71316 -8.165795</span></span>
<span><span class="co">#&gt; 777  3390588321 41.88845 -7.030557</span></span>
<span><span class="co">#&gt; 778  3390588320 41.43945 -7.774311</span></span>
<span><span class="co">#&gt; 779  3390588319 41.42194 -7.822505</span></span>
<span><span class="co">#&gt; 780  3390588318 41.85490 -7.886883</span></span>
<span><span class="co">#&gt; 781  3390588315 42.00192 -8.246556</span></span>
<span><span class="co">#&gt; 782  3390588310 39.34510 -7.405832</span></span>
<span><span class="co">#&gt; 783  3384283434 41.31493 -8.257731</span></span>
<span><span class="co">#&gt; 784  3384032591 40.89956 -8.236110</span></span>
<span><span class="co">#&gt; 785  3383987429 41.31493 -8.257731</span></span>
<span><span class="co">#&gt; 786  3355554412 41.16513 -8.024694</span></span>
<span><span class="co">#&gt; 787  3355482953 39.76608 -8.722703</span></span>
<span><span class="co">#&gt; 788  3355429222 41.88071 -8.268456</span></span>
<span><span class="co">#&gt; 789  3355111133 41.31493 -8.257731</span></span>
<span><span class="co">#&gt; 790  3344133771 39.49644 -9.053765</span></span>
<span><span class="co">#&gt; 791  3344058720 40.32542 -7.679457</span></span>
<span><span class="co">#&gt; 792  3343928818 41.71674 -8.306244</span></span>
<span><span class="co">#&gt; 793  3338021879 40.67482 -8.147830</span></span>
<span><span class="co">#&gt; 794  3337969276 41.85034 -8.708264</span></span>
<span><span class="co">#&gt; 795  3337814053 40.45982 -8.699257</span></span>
<span><span class="co">#&gt; 796  3337522793 41.90394 -8.313740</span></span>
<span><span class="co">#&gt; 797  3333553516 41.19651 -8.286673</span></span>
<span><span class="co">#&gt; 798  3333322755 41.19677 -8.286339</span></span>
<span><span class="co">#&gt; 799  3333087262 41.30550 -8.013683</span></span>
<span><span class="co">#&gt; 800  3330449692 41.33464 -7.803995</span></span>
<span><span class="co">#&gt; 801  3329293007 40.79827 -7.930406</span></span>
<span><span class="co">#&gt; 802  3329292643 40.62208 -8.360187</span></span>
<span><span class="co">#&gt; 804  3329292489 41.47911 -8.463901</span></span>
<span><span class="co">#&gt; 805  3329292218 41.43395 -8.163685</span></span>
<span><span class="co">#&gt; 806  3329291164 41.30013 -8.450164</span></span>
<span><span class="co">#&gt; 807  3329290889 40.23326 -7.252807</span></span>
<span><span class="co">#&gt; 808  3329290293 41.59946 -6.982664</span></span>
<span><span class="co">#&gt; 809  3329289525 40.30044 -7.037613</span></span>
<span><span class="co">#&gt; 810  3329289416 41.75964 -8.508078</span></span>
<span><span class="co">#&gt; 811  3329289405 40.43793 -7.682814</span></span>
<span><span class="co">#&gt; 812  3329289345 40.18139 -7.937795</span></span>
<span><span class="co">#&gt; 813  3329289078 40.81415 -7.741975</span></span>
<span><span class="co">#&gt; 814  3329288931 41.53684 -8.136827</span></span>
<span><span class="co">#&gt; 815  3329288878 39.32383 -7.409703</span></span>
<span><span class="co">#&gt; 816  3329288495 40.29993 -6.966788</span></span>
<span><span class="co">#&gt; 817  3329287995 40.80019 -7.865224</span></span>
<span><span class="co">#&gt; 818  3329287794 38.28950 -8.062067</span></span>
<span><span class="co">#&gt; 819  3329287308 40.54416 -8.191079</span></span>
<span><span class="co">#&gt; 820  3329286256 39.32098 -7.318697</span></span>
<span><span class="co">#&gt; 821  3329286062 41.20594 -7.337775</span></span>
<span><span class="co">#&gt; 822  3329285642 41.77013 -8.427015</span></span>
<span><span class="co">#&gt; 823  3329285403 41.80095 -8.808292</span></span>
<span><span class="co">#&gt; 824  3329284841 41.92975 -6.851007</span></span>
<span><span class="co">#&gt; 825  3329284082 41.88093 -8.546836</span></span>
<span><span class="co">#&gt; 826  3329283912 40.90548 -7.653728</span></span>
<span><span class="co">#&gt; 828  3329283703 40.17311 -7.932686</span></span>
<span><span class="co">#&gt; 829  3329283485 40.45912 -7.139199</span></span>
<span><span class="co">#&gt; 830  3329283360 41.35113 -8.275640</span></span>
<span><span class="co">#&gt; 831  3329283212 40.92608 -7.189482</span></span>
<span><span class="co">#&gt; 832  3329283194 40.68944 -8.006563</span></span>
<span><span class="co">#&gt; 833  3329283189 39.32081 -7.318469</span></span>
<span><span class="co">#&gt; 834  3329283151 40.98469 -8.016802</span></span>
<span><span class="co">#&gt; 835  3329282785 41.21284 -7.325327</span></span>
<span><span class="co">#&gt; 836  3329282652 40.62333 -8.363190</span></span>
<span><span class="co">#&gt; 837  3329282362 40.06480 -8.003267</span></span>
<span><span class="co">#&gt; 838  3329281650 40.98857 -8.369366</span></span>
<span><span class="co">#&gt; 839  3329281274 41.52545 -7.980517</span></span>
<span><span class="co">#&gt; 840  3329281147 40.11942 -8.550599</span></span>
<span><span class="co">#&gt; 841  3329280937 40.05002 -8.005264</span></span>
<span><span class="co">#&gt; 842  3329280489 40.80193 -8.123279</span></span>
<span><span class="co">#&gt; 843  3329280435 41.88278 -8.556417</span></span>
<span><span class="co">#&gt; 844  3329280402 39.30109 -7.349788</span></span>
<span><span class="co">#&gt; 845  3329280401 39.87476 -7.978568</span></span>
<span><span class="co">#&gt; 846  3329280295 40.75816 -8.595894</span></span>
<span><span class="co">#&gt; 847  3329280068 40.32426 -8.304472</span></span>
<span><span class="co">#&gt; 848  3329280050 40.79479 -7.935689</span></span>
<span><span class="co">#&gt; 849  3329279931 40.81977 -7.944811</span></span>
<span><span class="co">#&gt; 850  3329278939 41.00465 -7.040703</span></span>
<span><span class="co">#&gt; 851  3329278834 41.00228 -7.965674</span></span>
<span><span class="co">#&gt; 852  3329278573 40.17715 -8.426964</span></span>
<span><span class="co">#&gt; 853  3329277877 41.46072 -8.279451</span></span>
<span><span class="co">#&gt; 855  3329277708 40.33114 -8.307957</span></span>
<span><span class="co">#&gt; 856  3329277146 40.30354 -8.688116</span></span>
<span><span class="co">#&gt; 857  3329276875 40.17129 -8.397171</span></span>
<span><span class="co">#&gt; 858  3329276267 40.76254 -7.909937</span></span>
<span><span class="co">#&gt; 859  3329274822 41.21222 -7.328873</span></span>
<span><span class="co">#&gt; 860  3329274757 38.14434 -8.050680</span></span>
<span><span class="co">#&gt; 861  3329274207 41.46729 -6.881023</span></span>
<span><span class="co">#&gt; 862  3329274076 40.09568 -8.537851</span></span>
<span><span class="co">#&gt; 863  3329273492 40.84940 -7.512144</span></span>
<span><span class="co">#&gt; 864  3329273030 41.89388 -8.555810</span></span>
<span><span class="co">#&gt; 865  3329272959 40.04882 -8.002632</span></span>
<span><span class="co">#&gt; 866  3329272801 40.34474 -8.713571</span></span>
<span><span class="co">#&gt; 867  3329272798 40.64800 -7.833212</span></span>
<span><span class="co">#&gt; 868  3329272294 40.74691 -8.199169</span></span>
<span><span class="co">#&gt; 869  3329272221 39.47958 -8.232746</span></span>
<span><span class="co">#&gt; 870  3329272189 40.55999 -8.025016</span></span>
<span><span class="co">#&gt; 871  3329272143 41.89364 -8.555848</span></span>
<span><span class="co">#&gt; 872  3329272091 41.71129 -8.665769</span></span>
<span><span class="co">#&gt; 873  3329271080 40.84172 -8.597462</span></span>
<span><span class="co">#&gt; 874  3329270605 40.35631 -8.049071</span></span>
<span><span class="co">#&gt; 875  3329270302 41.44566 -8.753304</span></span>
<span><span class="co">#&gt; 876  3329270193 41.40641 -8.204237</span></span>
<span><span class="co">#&gt; 877  3329270137 40.59277 -7.629190</span></span>
<span><span class="co">#&gt; 878  3329269664 40.55015 -8.236240</span></span>
<span><span class="co">#&gt; 879  3329268998 40.22743 -7.832010</span></span>
<span><span class="co">#&gt; 880  3329268625 39.40389 -9.074734</span></span>
<span><span class="co">#&gt; 881  3329268601 40.06502 -8.102769</span></span>
<span><span class="co">#&gt; 882  3329268500 40.31277 -7.003000</span></span>
<span><span class="co">#&gt; 883  3329268250 41.50371 -8.242478</span></span>
<span><span class="co">#&gt; 884  3329268211 40.42511 -8.754608</span></span>
<span><span class="co">#&gt; 885  3329268192 41.71394 -8.497860</span></span>
<span><span class="co">#&gt; 886  3329268059 40.99385 -7.342022</span></span>
<span><span class="co">#&gt; 887  3329267484 40.78550 -8.350278</span></span>
<span><span class="co">#&gt; 888  3329267045 39.97873 -8.576666</span></span>
<span><span class="co">#&gt; 889  3329266549 39.99827 -8.744826</span></span>
<span><span class="co">#&gt; 890  3329265979 41.01000 -7.020330</span></span>
<span><span class="co">#&gt; 891  3329265750 40.61655 -8.608747</span></span>
<span><span class="co">#&gt; 892  3329265659 40.17984 -8.423253</span></span>
<span><span class="co">#&gt; 893  3329265562 41.16039 -7.338355</span></span>
<span><span class="co">#&gt; 894  3329265299 41.22146 -8.027222</span></span>
<span><span class="co">#&gt; 895  3329265296 41.31373 -8.554012</span></span>
<span><span class="co">#&gt; 896  3329265256 40.07628 -7.725050</span></span>
<span><span class="co">#&gt; 897  3329265135 41.21260 -7.320383</span></span>
<span><span class="co">#&gt; 898  3329265058 40.88559 -7.909962</span></span>
<span><span class="co">#&gt; 899  3329264463 39.13289 -8.677529</span></span>
<span><span class="co">#&gt; 900  3329264362 40.73346 -8.403175</span></span>
<span><span class="co">#&gt; 901  3329264206 40.32114 -7.594683</span></span>
<span><span class="co">#&gt; 902  3329264135 40.88774 -7.913250</span></span>
<span><span class="co">#&gt; 903  3329263242 39.79958 -8.770150</span></span>
<span><span class="co">#&gt; 904  3329263172 41.32134 -8.729542</span></span>
<span><span class="co">#&gt; 905  3329263117 39.77781 -8.035293</span></span>
<span><span class="co">#&gt; 906  3329262770 41.27965 -8.731684</span></span>
<span><span class="co">#&gt; 907  3329262614 39.72223 -8.510228</span></span>
<span><span class="co">#&gt; 908  3329262405 41.40157 -8.075658</span></span>
<span><span class="co">#&gt; 909  3329262357 40.86014 -7.912871</span></span>
<span><span class="co">#&gt; 910  3329262321 41.89324 -8.520350</span></span>
<span><span class="co">#&gt; 911  3329261495 40.76322 -8.170042</span></span>
<span><span class="co">#&gt; 912  3329261363 40.85510 -8.351734</span></span>
<span><span class="co">#&gt; 913  3329261335 41.66934 -8.665709</span></span>
<span><span class="co">#&gt; 914  3329261289 40.83051 -8.158470</span></span>
<span><span class="co">#&gt; 915  3329261080 41.75645 -8.459314</span></span>
<span><span class="co">#&gt; 916  3329260948 41.50521 -7.251483</span></span>
<span><span class="co">#&gt; 917  3329260253 39.81100 -8.253795</span></span>
<span><span class="co">#&gt; 918  3329260124 39.44980 -9.091008</span></span>
<span><span class="co">#&gt; 919  3329260102 40.09333 -7.911411</span></span>
<span><span class="co">#&gt; 920  3329259974 41.66926 -8.687368</span></span>
<span><span class="co">#&gt; 921  3329257778 40.80162 -8.627247</span></span>
<span><span class="co">#&gt; 922  3329257684 39.81313 -8.222964</span></span>
<span><span class="co">#&gt; 923  3329257621 40.00383 -8.116083</span></span>
<span><span class="co">#&gt; 924  3329257280 41.78401 -7.176541</span></span>
<span><span class="co">#&gt; 925  3329256605 39.30069 -7.350284</span></span>
<span><span class="co">#&gt; 926  3329256397 40.60728 -8.369051</span></span>
<span><span class="co">#&gt; 927  3329256396 41.39631 -8.095865</span></span>
<span><span class="co">#&gt; 928  3329256334 39.74861 -8.713499</span></span>
<span><span class="co">#&gt; 929  3329255580 39.70804 -8.604141</span></span>
<span><span class="co">#&gt; 930  3329255378 41.76828 -8.425119</span></span>
<span><span class="co">#&gt; 931  3329255186 40.81262 -7.751607</span></span>
<span><span class="co">#&gt; 932  3329255118 40.97396 -8.641266</span></span>
<span><span class="co">#&gt; 933  3329254004 41.87921 -8.706823</span></span>
<span><span class="co">#&gt; 934  3329253774 41.03691 -8.306363</span></span>
<span><span class="co">#&gt; 935  3329253656 40.23111 -7.830172</span></span>
<span><span class="co">#&gt; 936  3329253374 40.17881 -8.423344</span></span>
<span><span class="co">#&gt; 937  3329252898 41.52615 -8.563536</span></span>
<span><span class="co">#&gt; 938  3329252897 40.04944 -7.999505</span></span>
<span><span class="co">#&gt; 939  3329252876 40.89557 -7.975600</span></span>
<span><span class="co">#&gt; 940  3329252841 40.68882 -8.005756</span></span>
<span><span class="co">#&gt; 941  3329252719 39.27257 -7.366605</span></span>
<span><span class="co">#&gt; 942  3329252391 40.33365 -6.789421</span></span>
<span><span class="co">#&gt; 943  3329252258 41.41467 -8.188689</span></span>
<span><span class="co">#&gt; 944  3329252102 41.29927 -8.450195</span></span>
<span><span class="co">#&gt; 945  3329252028 41.47109 -8.578420</span></span>
<span><span class="co">#&gt; 946  3329251770 39.87230 -8.345529</span></span>
<span><span class="co">#&gt; 947  3329251524 41.44397 -7.673695</span></span>
<span><span class="co">#&gt; 948  3329251287 40.86075 -7.913882</span></span>
<span><span class="co">#&gt; 949  3329249557 39.20990 -7.293589</span></span>
<span><span class="co">#&gt; 950  3329249265 40.33659 -7.160206</span></span>
<span><span class="co">#&gt; 951  3329248958 40.14062 -8.560379</span></span>
<span><span class="co">#&gt; 952  3329248791 39.82900 -8.190883</span></span>
<span><span class="co">#&gt; 953  3329248578 40.08343 -8.606221</span></span>
<span><span class="co">#&gt; 954  3329248004 39.97836 -8.780291</span></span>
<span><span class="co">#&gt; 955  3329247839 39.71666 -8.466260</span></span>
<span><span class="co">#&gt; 956  3329247089 39.21079 -7.294957</span></span>
<span><span class="co">#&gt; 957  3329246963 41.58490 -8.214442</span></span>
<span><span class="co">#&gt; 958  3329246632 41.52477 -7.980096</span></span>
<span><span class="co">#&gt; 959  3329246610 41.22547 -8.459798</span></span>
<span><span class="co">#&gt; 960  3329246597 40.07315 -8.655712</span></span>
<span><span class="co">#&gt; 961  3329246330 41.52504 -7.980344</span></span>
<span><span class="co">#&gt; 962  3329246328 39.69417 -8.270858</span></span>
<span><span class="co">#&gt; 963  3329246131 40.67806 -8.130962</span></span>
<span><span class="co">#&gt; 964  3329245783 40.28729 -6.887813</span></span>
<span><span class="co">#&gt; 965  3329245454 40.83295 -8.156684</span></span>
<span><span class="co">#&gt; 966  3329244895 41.16444 -7.348718</span></span>
<span><span class="co">#&gt; 967  3329243367 39.39241 -7.327004</span></span>
<span><span class="co">#&gt; 968  3329243036 41.37094 -7.999303</span></span>
<span><span class="co">#&gt; 969  3329242919 40.42877 -8.588924</span></span>
<span><span class="co">#&gt; 970  3329242503 40.94492 -7.934767</span></span>
<span><span class="co">#&gt; 971  3329242288 41.20867 -7.476886</span></span>
<span><span class="co">#&gt; 972  3329242226 41.43275 -8.163485</span></span>
<span><span class="co">#&gt; 973  3329242179 41.56036 -8.101197</span></span>
<span><span class="co">#&gt; 974  3329241813 40.88610 -7.910346</span></span>
<span><span class="co">#&gt; 975  3329241617 39.27173 -7.365801</span></span>
<span><span class="co">#&gt; 976  3329241457 40.22941 -7.826170</span></span>
<span><span class="co">#&gt; 977  3329241354 39.33458 -7.373922</span></span>
<span><span class="co">#&gt; 978  3329241325 41.00033 -7.959415</span></span>
<span><span class="co">#&gt; 979  3329241313 40.38082 -7.213919</span></span>
<span><span class="co">#&gt; 980  3329241311 40.10979 -8.135222</span></span>
<span><span class="co">#&gt; 981  3329240837 40.31269 -7.004638</span></span>
<span><span class="co">#&gt; 983  3329240656 39.75410 -8.273740</span></span>
<span><span class="co">#&gt; 984  3329240509 39.97857 -8.781403</span></span>
<span><span class="co">#&gt; 985  3329240503 41.10537 -8.291460</span></span>
<span><span class="co">#&gt; 986  3329240371 41.69253 -8.484147</span></span>
<span><span class="co">#&gt; 987  3329240302 41.89251 -8.553469</span></span>
<span><span class="co">#&gt; 988  3329240177 40.57657 -7.468421</span></span>
<span><span class="co">#&gt; 989  3329239499 40.83094 -8.040520</span></span>
<span><span class="co">#&gt; 990  3329238885 40.57944 -7.986429</span></span>
<span><span class="co">#&gt; 991  3329238706 41.52142 -7.232687</span></span>
<span><span class="co">#&gt; 992  3329237581 40.06742 -8.731552</span></span>
<span><span class="co">#&gt; 993  3329237541 41.71913 -6.857837</span></span>
<span><span class="co">#&gt; 994  3329237325 40.31319 -6.988419</span></span>
<span><span class="co">#&gt; 995  3329237307 41.03934 -7.510086</span></span>
<span><span class="co">#&gt; 996  3329236759 40.00478 -8.109193</span></span>
<span><span class="co">#&gt; 997  3329236660 41.13220 -8.230756</span></span>
<span><span class="co">#&gt; 998  3329236628 40.81532 -7.742118</span></span>
<span><span class="co">#&gt; 999  3329236543 40.18139 -7.937795</span></span>
<span><span class="co">#&gt; 1000 3329235840 41.16039 -7.338355</span></span>
<span><span class="co">#&gt; 1001 3329235624 40.17879 -8.423344</span></span>
<span><span class="co">#&gt; 1002 3329235538 40.07722 -7.489520</span></span>
<span><span class="co">#&gt; 1003 3329235027 40.74497 -8.200614</span></span>
<span><span class="co">#&gt; 1004 3329234984 40.90220 -8.017028</span></span>
<span><span class="co">#&gt; 1005 3329234891 41.32958 -8.215425</span></span>
<span><span class="co">#&gt; 1006 3329234444 40.10671 -8.635760</span></span>
<span><span class="co">#&gt; 1007 3329233983 40.44031 -7.598147</span></span>
<span><span class="co">#&gt; 1008 3329233821 41.01649 -7.596240</span></span>
<span><span class="co">#&gt; 1009 3329233670 39.60229 -8.290854</span></span>
<span><span class="co">#&gt; 1010 3329232644 40.77072 -7.328269</span></span>
<span><span class="co">#&gt; 1011 3329232265 40.23934 -7.262936</span></span>
<span><span class="co">#&gt; 1012 3329232002 40.95994 -7.041040</span></span>
<span><span class="co">#&gt; 1013 3329231973 41.47861 -8.458120</span></span>
<span><span class="co">#&gt; 1014 3329231279 39.25212 -7.307283</span></span>
<span><span class="co">#&gt; 1015 3329231248 40.00846 -8.365027</span></span>
<span><span class="co">#&gt; 1016 3329230868 39.13883 -8.739823</span></span>
<span><span class="co">#&gt; 1017 3329230750 40.97773 -8.319131</span></span>
<span><span class="co">#&gt; 1018 3329230582 40.36025 -8.305775</span></span>
<span><span class="co">#&gt; 1019 3329230479 39.74024 -8.711655</span></span>
<span><span class="co">#&gt; 1020 3329229853 40.33376 -6.788417</span></span>
<span><span class="co">#&gt; 1021 3329229550 41.31180 -8.693084</span></span>
<span><span class="co">#&gt; 1022 3329228895 41.97741 -6.796891</span></span>
<span><span class="co">#&gt; 1023 3329228573 41.89390 -8.555810</span></span>
<span><span class="co">#&gt; 1024 3329228057 40.56777 -8.138864</span></span>
<span><span class="co">#&gt; 1025 3329228049 41.32126 -8.223232</span></span>
<span><span class="co">#&gt; 1026 3329227210 39.39429 -7.324660</span></span>
<span><span class="co">#&gt; 1027 3329226869 40.26048 -7.096915</span></span>
<span><span class="co">#&gt; 1028 3329226802 40.92141 -8.382510</span></span>
<span><span class="co">#&gt; 1029 3329226486 40.50972 -7.361537</span></span>
<span><span class="co">#&gt; 1030 3329226099 39.73339 -8.059449</span></span>
<span><span class="co">#&gt; 1031 3329225343 41.93110 -8.532780</span></span>
<span><span class="co">#&gt; 1032 3329225143 39.47505 -8.240865</span></span>
<span><span class="co">#&gt; 1033 3329224148 40.12043 -7.588182</span></span>
<span><span class="co">#&gt; 1034 3329224014 40.35682 -8.271140</span></span>
<span><span class="co">#&gt; 1035 3329223556 40.30103 -7.081481</span></span>
<span><span class="co">#&gt; 1036 3329223477 41.80021 -8.818573</span></span>
<span><span class="co">#&gt; 1037 3329223385 40.77072 -7.328269</span></span>
<span><span class="co">#&gt; 1038 3329222702 40.08596 -7.865174</span></span>
<span><span class="co">#&gt; 1039 3329222597 40.59228 -7.628751</span></span>
<span><span class="co">#&gt; 1040 3329222569 40.99286 -7.343711</span></span>
<span><span class="co">#&gt; 1041 3329222385 41.39733 -8.077034</span></span>
<span><span class="co">#&gt; 1042 3329221987 41.33928 -8.233368</span></span>
<span><span class="co">#&gt; 1043 3329221800 41.16039 -7.338355</span></span>
<span><span class="co">#&gt; 1044 3329221795 40.08337 -8.685898</span></span>
<span><span class="co">#&gt; 1045 3329221718 41.89706 -8.558343</span></span>
<span><span class="co">#&gt; 1046 3329221669 41.87868 -8.542236</span></span>
<span><span class="co">#&gt; 1047 3329221429 39.74366 -8.712551</span></span>
<span><span class="co">#&gt; 1048 3329221247 41.03665 -8.306188</span></span>
<span><span class="co">#&gt; 1049 3329219888 41.47375 -8.267618</span></span>
<span><span class="co">#&gt; 1050 3329219813 41.65409 -7.175876</span></span>
<span><span class="co">#&gt; 1051 3329219266 41.89469 -8.557419</span></span>
<span><span class="co">#&gt; 1053 3329218886 40.29223 -6.881883</span></span>
<span><span class="co">#&gt; 1054 3329218486 40.93601 -8.339373</span></span>
<span><span class="co">#&gt; 1055 3329218222 39.19787 -7.235137</span></span>
<span><span class="co">#&gt; 1056 3329217651 39.72253 -8.509911</span></span>
<span><span class="co">#&gt; 1057 3329217509 39.79390 -7.464717</span></span>
<span><span class="co">#&gt; 1058 3329217484 40.71705 -7.353480</span></span>
<span><span class="co">#&gt; 1059 3329217480 39.78458 -8.628064</span></span>
<span><span class="co">#&gt; 1060 3329217268 41.89030 -8.530534</span></span>
<span><span class="co">#&gt; 1061 3329217196 40.65565 -7.845097</span></span>
<span><span class="co">#&gt; 1062 3329217076 40.92800 -7.059585</span></span>
<span><span class="co">#&gt; 1063 3329216967 40.97365 -8.324902</span></span>
<span><span class="co">#&gt; 1064 3329216709 40.37176 -7.129368</span></span>
<span><span class="co">#&gt; 1065 3329216595 40.36019 -8.286850</span></span>
<span><span class="co">#&gt; 1066 3329216398 40.79310 -7.861979</span></span>
<span><span class="co">#&gt; 1067 3329215990 39.33543 -7.374622</span></span>
<span><span class="co">#&gt; 1068 3329215429 40.94187 -7.929803</span></span>
<span><span class="co">#&gt; 1069 3329214435 41.96264 -7.106005</span></span>
<span><span class="co">#&gt; 1070 3329214108 41.60223 -8.602288</span></span>
<span><span class="co">#&gt; 1071 3329213871 40.74497 -8.200614</span></span>
<span><span class="co">#&gt; 1072 3329213226 39.26543 -7.297875</span></span>
<span><span class="co">#&gt; 1073 3329213107 40.03876 -8.193203</span></span>
<span><span class="co">#&gt; 1075 3329213063 40.07160 -8.338665</span></span>
<span><span class="co">#&gt; 1076 3329212780 41.90885 -8.550545</span></span>
<span><span class="co">#&gt; 1077 3329212737 40.69075 -8.004307</span></span>
<span><span class="co">#&gt; 1078 3329212394 41.52819 -8.189849</span></span>
<span><span class="co">#&gt; 1079 3329212361 41.89684 -8.497238</span></span>
<span><span class="co">#&gt; 1080 3329212162 40.67135 -8.200169</span></span>
<span><span class="co">#&gt; 1081 3329211674 41.81407 -7.919885</span></span>
<span><span class="co">#&gt; 1082 3329211435 41.44390 -8.750497</span></span>
<span><span class="co">#&gt; 1083 3329211410 39.31996 -7.999063</span></span>
<span><span class="co">#&gt; 1084 3327946053 40.32822 -7.586815</span></span>
<span><span class="co">#&gt; 1085 3327764029 40.65869 -8.149047</span></span>
<span><span class="co">#&gt; 1086 3325960476 40.72036 -8.538632</span></span>
<span><span class="co">#&gt; 1087 3325781989 40.32800 -7.587047</span></span>
<span><span class="co">#&gt; 1088 3321164780 41.83132 -7.942085</span></span>
<span><span class="co">#&gt; 1089 3307291805 41.49652 -8.243656</span></span>
<span><span class="co">#&gt; 1090 3307271877 40.32037 -8.566488</span></span>
<span><span class="co">#&gt; 1091 3307182822 41.78869 -8.591312</span></span>
<span><span class="co">#&gt; 1092 3307161738 41.49651 -8.243683</span></span>
<span><span class="co">#&gt; 1093 3302539581 41.50533 -8.161291</span></span>
<span><span class="co">#&gt; 1094 3302233883 41.31493 -8.257731</span></span>
<span><span class="co">#&gt; 1095 3301982830 41.38788 -8.265899</span></span>
<span><span class="co">#&gt; 1096 3301826816 41.33477 -7.803562</span></span>
<span><span class="co">#&gt; 1097 3124825852 42.03279 -8.163900</span></span>
<span><span class="co">#&gt; 1098 3124779788 42.05133 -8.198026</span></span>
<span><span class="co">#&gt; 1099 3124754035 41.22317 -8.561836</span></span>
<span><span class="co">#&gt; 1100 3124604519 39.44886 -9.133770</span></span>
<span><span class="co">#&gt; 1101 3124488826 41.87712 -8.256831</span></span>
<span><span class="co">#&gt; 1102 3118420503 41.15581 -8.408566</span></span>
<span><span class="co">#&gt; 1103 3118391236 39.43973 -9.143595</span></span>
<span><span class="co">#&gt; 1104 3117881727 41.09676 -8.484416</span></span>
<span><span class="co">#&gt; 1105 3113529636 41.52669 -8.630224</span></span>
<span><span class="co">#&gt; 1106 3112407006 41.23718 -8.709723</span></span>
<span><span class="co">#&gt; 1107 3109252420 41.80656 -8.858371</span></span>
<span><span class="co">#&gt; 1108 3109183625 41.40160 -8.217143</span></span>
<span><span class="co">#&gt; 1109 3097274255 40.63201 -8.109882</span></span>
<span><span class="co">#&gt; 1110 3097106695 41.80341 -8.128234</span></span>
<span><span class="co">#&gt; 1111 3090715918 41.71145 -8.817823</span></span>
<span><span class="co">#&gt; 1112 3079864025 41.21568 -8.251008</span></span>
<span><span class="co">#&gt; 1113 3079862130 41.13973 -8.269148</span></span>
<span><span class="co">#&gt; 1114 3079584556 40.11270 -8.514184</span></span>
<span><span class="co">#&gt; 1115 3070748544 41.12344 -8.437679</span></span>
<span><span class="co">#&gt; 1116 3067983204 40.84669 -8.474585</span></span>
<span><span class="co">#&gt; 1119 2992761833 40.99824 -8.621130</span></span>
<span><span class="co">#&gt; 1120 2898528714 40.24081 -7.591225</span></span>
<span><span class="co">#&gt; 1121 2874008486 37.32097 -8.548824</span></span>
<span><span class="co">#&gt; 1122 2845585733 41.75710 -8.149500</span></span>
<span><span class="co">#&gt; 1123 2845542923 43.28971 -8.491898</span></span>
<span><span class="co">#&gt; 1124 2845516149 43.30898 -8.477036</span></span>
<span><span class="co">#&gt; 1125 2845349904 43.31149 -8.507613</span></span>
<span><span class="co">#&gt; 1126 2845334615 43.32957 -8.497227</span></span>
<span><span class="co">#&gt; 1127 2845293407 43.28848 -6.434583</span></span>
<span><span class="co">#&gt; 1128 2845132346 43.28847 -8.581265</span></span>
<span><span class="co">#&gt; 1129 2844723836 43.33248 -4.874070</span></span>
<span><span class="co">#&gt; 1130 2844618545 40.25159 -5.652627</span></span>
<span><span class="co">#&gt; 1131 2844378197 43.04453 -6.254827</span></span>
<span><span class="co">#&gt; 1132 2844154155 43.29387 -8.555052</span></span>
<span><span class="co">#&gt; 1133 2843867361 40.15298 -8.236695</span></span>
<span><span class="co">#&gt; 1134 2843562133 40.19912 -5.746585</span></span>
<span><span class="co">#&gt; 1135 2843403263 43.31809 -8.456978</span></span>
<span><span class="co">#&gt; 1136 2843301951 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1137 2843093231 41.96983 -8.373956</span></span>
<span><span class="co">#&gt; 1138 2843004378 40.21925 -5.696695</span></span>
<span><span class="co">#&gt; 1139 2842929767 42.43000 -8.570000</span></span>
<span><span class="co">#&gt; 1140 2842870786 41.75000 -8.150000</span></span>
<span><span class="co">#&gt; 1141 2842651692 40.24732 -5.630430</span></span>
<span><span class="co">#&gt; 1142 2842642419 42.12057 -6.698999</span></span>
<span><span class="co">#&gt; 1143 2842549036 41.07755 -3.466298</span></span>
<span><span class="co">#&gt; 1144 2842359348 43.34130 -8.477517</span></span>
<span><span class="co">#&gt; 1145 2842334059 40.05896 -8.257942</span></span>
<span><span class="co">#&gt; 1146 2842244019 43.29786 -8.424032</span></span>
<span><span class="co">#&gt; 1147 2842197327 40.18448 -5.826730</span></span>
<span><span class="co">#&gt; 1148 2842193042 39.48495 -5.394226</span></span>
<span><span class="co">#&gt; 1149 2841838788 43.33014 -4.880765</span></span>
<span><span class="co">#&gt; 1150 2841364775 40.21499 -5.751517</span></span>
<span><span class="co">#&gt; 1151 2841355546 40.31148 -5.286775</span></span>
<span><span class="co">#&gt; 1152 2841329348 40.33873 -5.130339</span></span>
<span><span class="co">#&gt; 1153 2841316543 40.24914 -5.268631</span></span>
<span><span class="co">#&gt; 1154 2841129966 43.03182 -6.866026</span></span>
<span><span class="co">#&gt; 1155 2841066720 40.11677 -5.777357</span></span>
<span><span class="co">#&gt; 1156 2840890164 40.33886 -5.130678</span></span>
<span><span class="co">#&gt; 1157 2840889720 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1158 2840870836 41.73683 -8.199550</span></span>
<span><span class="co">#&gt; 1159 2840830738 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1160 2840594896 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1161 2840525475 40.06247 -5.856696</span></span>
<span><span class="co">#&gt; 1162 2840523224 43.11069 -5.977732</span></span>
<span><span class="co">#&gt; 1163 2840312658 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1164 2840306004 41.08000 -3.450000</span></span>
<span><span class="co">#&gt; 1165 2840303817 42.89175 -6.795387</span></span>
<span><span class="co">#&gt; 1166 2840292852 41.97207 -8.374844</span></span>
<span><span class="co">#&gt; 1167 2840244813 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1168 2840185623 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1169 2840162233 40.17000 -5.650300</span></span>
<span><span class="co">#&gt; 1170 2840145487 40.75691 -3.904489</span></span>
<span><span class="co">#&gt; 1171 2840142275 39.49710 -8.231414</span></span>
<span><span class="co">#&gt; 1172 2840134830 41.73141 -8.208388</span></span>
<span><span class="co">#&gt; 1173 2840129413 41.76089 -8.123175</span></span>
<span><span class="co">#&gt; 1175 2840082387 41.18265 -8.231380</span></span>
<span><span class="co">#&gt; 1176 2840042179 41.66050 -8.173500</span></span>
<span><span class="co">#&gt; 1177 2840017878 40.24707 -5.095995</span></span>
<span><span class="co">#&gt; 1178 2839982802 40.99556 -7.930924</span></span>
<span><span class="co">#&gt; 1179 2839974632 40.18682 -7.878788</span></span>
<span><span class="co">#&gt; 1180 2839972578 40.86818 -8.287479</span></span>
<span><span class="co">#&gt; 1181 2839953172 41.67700 -7.714682</span></span>
<span><span class="co">#&gt; 1182 2839928622 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1183 2839907297 40.88343 -3.735452</span></span>
<span><span class="co">#&gt; 1184 2839825133 40.21632 -7.919050</span></span>
<span><span class="co">#&gt; 1185 2839809180 42.63835 -7.143388</span></span>
<span><span class="co">#&gt; 1186 2839682166 43.32225 -8.451903</span></span>
<span><span class="co">#&gt; 1187 2839599293 41.77272 -8.173882</span></span>
<span><span class="co">#&gt; 1188 2839543911 39.41503 -7.450761</span></span>
<span><span class="co">#&gt; 1189 2839434925 43.15211 -5.600696</span></span>
<span><span class="co">#&gt; 1190 2839407375 42.11769 -6.715107</span></span>
<span><span class="co">#&gt; 1191 2839356244 40.25123 -5.287739</span></span>
<span><span class="co">#&gt; 1192 2839310357 40.36715 -7.727330</span></span>
<span><span class="co">#&gt; 1193 2839295245 40.31514 -5.770912</span></span>
<span><span class="co">#&gt; 1194 2839207300 42.13130 -6.730400</span></span>
<span><span class="co">#&gt; 1195 2839166262 42.12280 -6.746807</span></span>
<span><span class="co">#&gt; 1196 2839034042 40.93071 -8.234135</span></span>
<span><span class="co">#&gt; 1197 2839030636 40.47957 -6.117539</span></span>
<span><span class="co">#&gt; 1198 2838823725 40.27557 -5.231838</span></span>
<span><span class="co">#&gt; 1199 2838791606 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1200 2838778687 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1201 2838752247 41.76209 -8.209383</span></span>
<span><span class="co">#&gt; 1202 2838735563 40.50179 -6.220665</span></span>
<span><span class="co">#&gt; 1203 2838676866 42.80724 -6.760454</span></span>
<span><span class="co">#&gt; 1204 2838669598 40.48351 -6.109772</span></span>
<span><span class="co">#&gt; 1205 2838634562 40.49187 -6.195946</span></span>
<span><span class="co">#&gt; 1206 2838608913 40.20221 -5.756310</span></span>
<span><span class="co">#&gt; 1207 2838532905 40.72205 -8.114642</span></span>
<span><span class="co">#&gt; 1208 2838456682 41.76000 -8.150000</span></span>
<span><span class="co">#&gt; 1209 2838369301 42.56408 -7.223082</span></span>
<span><span class="co">#&gt; 1210 2838341128 39.45570 -8.341199</span></span>
<span><span class="co">#&gt; 1211 2838329042 40.76740 -3.991851</span></span>
<span><span class="co">#&gt; 1212 2837969737 43.30493 -8.459416</span></span>
<span><span class="co">#&gt; 1213 2837841247 40.30061 -5.056714</span></span>
<span><span class="co">#&gt; 1214 2837792104 40.46311 -6.149812</span></span>
<span><span class="co">#&gt; 1215 2837519261 43.32665 -8.409953</span></span>
<span><span class="co">#&gt; 1216 2837330897 40.13678 -5.667590</span></span>
<span><span class="co">#&gt; 1217 2837286494 40.11677 -5.777357</span></span>
<span><span class="co">#&gt; 1218 2837266233 43.09498 -7.046270</span></span>
<span><span class="co">#&gt; 1219 2836762392 41.75760 -8.193000</span></span>
<span><span class="co">#&gt; 1220 2836746137 41.08000 -3.460000</span></span>
<span><span class="co">#&gt; 1221 2836705492 40.18757 -5.149333</span></span>
<span><span class="co">#&gt; 1222 2836683836 40.31000 -5.200000</span></span>
<span><span class="co">#&gt; 1223 2836414814 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1224 2836355137 37.63849 -8.620611</span></span>
<span><span class="co">#&gt; 1225 2836335900 41.03139 -8.046394</span></span>
<span><span class="co">#&gt; 1226 2836330062 41.07724 -3.464272</span></span>
<span><span class="co">#&gt; 1227 2836300204 41.36648 -7.790171</span></span>
<span><span class="co">#&gt; 1228 2836285101 40.19830 -5.300700</span></span>
<span><span class="co">#&gt; 1229 2836186446 43.33715 -8.358267</span></span>
<span><span class="co">#&gt; 1230 2835994932 40.37393 -7.517241</span></span>
<span><span class="co">#&gt; 1231 2835979614 40.07515 -8.229189</span></span>
<span><span class="co">#&gt; 1232 2835972608 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1233 2835956692 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1234 2835836112 40.23184 -5.270004</span></span>
<span><span class="co">#&gt; 1235 2835730323 42.58437 -7.109184</span></span>
<span><span class="co">#&gt; 1236 2835676384 40.36617 -5.730057</span></span>
<span><span class="co">#&gt; 1237 2835671705 40.31000 -5.200000</span></span>
<span><span class="co">#&gt; 1238 2835605846 41.73529 -8.204877</span></span>
<span><span class="co">#&gt; 1239 2835556300 40.34079 -5.166244</span></span>
<span><span class="co">#&gt; 1240 2835520583 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1241 2835315306 43.30859 -8.539913</span></span>
<span><span class="co">#&gt; 1242 2835249043 40.38443 -7.704903</span></span>
<span><span class="co">#&gt; 1243 2835228741 41.90432 -6.380310</span></span>
<span><span class="co">#&gt; 1244 2835218217 40.24479 -7.950605</span></span>
<span><span class="co">#&gt; 1245 2835202861 40.13605 -5.667826</span></span>
<span><span class="co">#&gt; 1246 2834983824 43.09492 -7.045802</span></span>
<span><span class="co">#&gt; 1247 2834817357 40.06247 -5.856696</span></span>
<span><span class="co">#&gt; 1248 2834361613 41.74000 -8.170000</span></span>
<span><span class="co">#&gt; 1249 2834285996 40.38311 -7.545340</span></span>
<span><span class="co">#&gt; 1250 2834282668 40.38310 -7.545344</span></span>
<span><span class="co">#&gt; 1251 2834210083 43.33548 -8.479428</span></span>
<span><span class="co">#&gt; 1252 2834106611 40.25759 -5.655870</span></span>
<span><span class="co">#&gt; 1253 2833589613 40.06848 -5.711360</span></span>
<span><span class="co">#&gt; 1254 2833491788 42.08339 -8.678606</span></span>
<span><span class="co">#&gt; 1255 2833359648 42.33765 -8.444519</span></span>
<span><span class="co">#&gt; 1256 2833144483 40.15827 -5.656801</span></span>
<span><span class="co">#&gt; 1257 2833038154 40.11728 -5.777557</span></span>
<span><span class="co">#&gt; 1258 2833006260 40.32750 -5.130056</span></span>
<span><span class="co">#&gt; 1259 2832994801 41.97207 -8.374844</span></span>
<span><span class="co">#&gt; 1260 2832994638 41.03139 -8.046394</span></span>
<span><span class="co">#&gt; 1261 2832984061 40.22100 -5.141100</span></span>
<span><span class="co">#&gt; 1262 2832932466 41.57798 -8.230280</span></span>
<span><span class="co">#&gt; 1263 2832927493 40.16900 -5.650477</span></span>
<span><span class="co">#&gt; 1264 2832919246 40.27000 -5.240000</span></span>
<span><span class="co">#&gt; 1265 2832795760 41.13430 -8.664462</span></span>
<span><span class="co">#&gt; 1266 2832761972 40.22096 -5.749867</span></span>
<span><span class="co">#&gt; 1267 2832685385 42.10434 -6.770668</span></span>
<span><span class="co">#&gt; 1268 2832674015 40.36523 -5.045183</span></span>
<span><span class="co">#&gt; 1269 2832601288 40.36002 -5.762501</span></span>
<span><span class="co">#&gt; 1270 2832583582 41.78928 -8.153801</span></span>
<span><span class="co">#&gt; 1271 2832582758 40.27219 -5.234327</span></span>
<span><span class="co">#&gt; 1272 2832519117 40.12036 -5.776772</span></span>
<span><span class="co">#&gt; 1273 2832517081 40.45940 -6.144000</span></span>
<span><span class="co">#&gt; 1274 2832480115 39.36000 -7.390000</span></span>
<span><span class="co">#&gt; 1275 2832400951 43.02674 -6.863365</span></span>
<span><span class="co">#&gt; 1276 2832295330 42.63374 -7.133861</span></span>
<span><span class="co">#&gt; 1277 2832293209 42.58584 -7.055038</span></span>
<span><span class="co">#&gt; 1278 2832292205 41.80000 -8.140000</span></span>
<span><span class="co">#&gt; 1279 2832282319 40.24507 -7.950164</span></span>
<span><span class="co">#&gt; 1280 2832271078 40.36735 -7.727165</span></span>
<span><span class="co">#&gt; 1281 2832258818 42.75239 -8.173088</span></span>
<span><span class="co">#&gt; 1282 2832246684 40.18118 -7.861965</span></span>
<span><span class="co">#&gt; 1283 2832217151 40.21632 -7.918836</span></span>
<span><span class="co">#&gt; 1285 2626338858 41.82110 -8.297938</span></span>
<span><span class="co">#&gt; 1286 2626301455 38.79306 -9.422247</span></span>
<span><span class="co">#&gt; 1287 2521406365 41.26347 -7.442267</span></span>
<span><span class="co">#&gt; 1288 2521405897 41.40247 -7.465518</span></span>
<span><span class="co">#&gt; 1289 2521405667 41.35846 -7.403038</span></span>
<span><span class="co">#&gt; 1290 2464748146 41.72318 -8.129463</span></span>
<span><span class="co">#&gt; 1291 2442913242 37.28064 -8.555517</span></span>
<span><span class="co">#&gt; 1292 2442871645 41.75148 -8.201509</span></span>
<span><span class="co">#&gt; 1293 1945419094 41.24880 -7.811231</span></span>
<span><span class="co">#&gt; 1294 1890067578 39.30139 -9.217903</span></span>
<span><span class="co">#&gt; 1295 1580129201 38.08485 -6.422796</span></span>
<span><span class="co">#&gt; 1296 1562900214 39.30134 -9.218001</span></span>
<span><span class="co">#&gt; 1297 1338880563 37.34785 -8.816786</span></span></code></pre></div>
<p>Alternatively, we can easily access and manipulate this dataset using
<code>rbgif</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download presences</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rgbif" class="external-link">rgbif</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/rgbif/reference/occ_download_get.html" class="external-link">occ_download_get</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"0068808-230530130749713"</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># read file</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="va">distrib</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"0068808-230530130749713.zip"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># keep the necessary columns and rename them</span></span>
<span><span class="va">lacerta</span> <span class="op">&lt;-</span> <span class="va">distrib</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">gbifID</span>, <span class="va">decimalLatitude</span>, <span class="va">decimalLongitude</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">gbifID</span>, latitude <span class="op">=</span> <span class="va">decimalLatitude</span>, longitude <span class="op">=</span> <span class="va">decimalLongitude</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="preparing-your-data">Preparing your data<a class="anchor" aria-label="anchor" href="#preparing-your-data"></a>
</h2>
<p>First, let us visualise our presences by plotting on a map.
<code>tidysdm</code> works with <code>sf</code> objects to represent
locations, so we will cast our coordinates into an <code>sf</code>
object, and set its projections to standard ‘lonlat’ (<code>crs</code> =
4326).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Linking to GEOS 3.10.2, GDAL 3.4.1, PROJ 8.2.1; sf_use_s2() is TRUE</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">lacerta</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">lacerta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">4326</span></span></code></pre></div>
<p>It is usually advisable to plot the locations directly on the raster
that will be used to extract climatic variables, to see how the
locations fall within the discrete space of the raster. For this
vignette, we will use WorldClim as our source of climatic information.
We will access the WorldClim data via the library <code>pastclim</code>;
even though this library, as the name suggests, is mostly designed to
handle palaeoclimatic reconstructions, it also provides convenient
functions to access present day reconstructions and future projections.
<code>pastclim</code> has a handy function to get the land mask for the
available datasets, which we can use as background for our locations. We
will cut the raster to the Iberian peninsula, where our lizard lives.
For this simply illustration, we will not bother to project the raster,
but an equal area projection would be desirable…</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EvolEcolGroup/pastclim" class="external-link">pastclim</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/download_dataset.html" class="external-link">download_dataset</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="st">"WorldClim_2.1_10m"</span><span class="op">)</span></span>
<span><span class="va">land_mask</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/get_land_mask.html" class="external-link">get_land_mask</a></span><span class="op">(</span>time_ce <span class="op">=</span> <span class="fl">1985</span>, dataset <span class="op">=</span> <span class="st">"WorldClim_2.1_10m"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Iberia peninsula extension</span></span>
<span><span class="va">iberia_poly</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/vect.html" class="external-link">vect</a></span><span class="op">(</span></span>
<span>    <span class="st">"POLYGON((-9.8 43.3,-7.8 44.1,-2.0 43.7,3.6 42.5,3.8 41.5,1.3 40.8,0.3 39.5,</span></span>
<span><span class="st">     0.9 38.6,-0.4 37.5,-1.6 36.7,-2.3 36.3,-4.1 36.4,-4.5 36.4,-5.0 36.1,</span></span>
<span><span class="st">    -5.6 36.0,-6.3 36.0,-7.1 36.9,-9.5 36.6,-9.4 38.0,-10.6 38.9,-9.5 40.8,</span></span>
<span><span class="st">    -9.8 43.3))"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">iberia_poly</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"lonlat"</span></span>
<span><span class="co"># crop the extent</span></span>
<span><span class="va">land_mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/crop.html" class="external-link">crop</a></span><span class="op">(</span><span class="va">land_mask</span>, <span class="va">iberia_poly</span><span class="op">)</span></span>
<span><span class="co"># and mask to the polygon</span></span>
<span><span class="va">land_mask</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/mask.html" class="external-link">mask</a></span><span class="op">(</span><span class="va">land_mask</span>, <span class="va">iberia_poly</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; Loading required package: terra</span></span>
<span><span class="co">#&gt; terra 1.7.78</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'terra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:tidyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     extract</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:scales':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     rescale</span></span></code></pre>
<p>For plotting, we will take advantage of <code>tidyterra</code>, which
makes handling of <code>terra</code> rasters with <code>ggplot</code> a
breeze.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dieghernan.github.io/tidyterra/" class="external-link">tidyterra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidyterra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">land_mask</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">land_mask_1985</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="thinning-step">Thinning step<a class="anchor" aria-label="anchor" href="#thinning-step"></a>
</h2>
<p>Now, we thin the observations to have one per cell in the raster (it
would be better if we had an equal area projection…):</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234567</span><span class="op">)</span></span>
<span><span class="va">lacerta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_by_cell.html">thin_by_cell</a></span><span class="op">(</span><span class="va">lacerta</span>, raster <span class="op">=</span> <span class="va">land_mask</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lacerta</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 226</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">land_mask</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">land_mask_1985</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/plot_thin_by_cell-1.png" width="576"></p>
<p>Now, we thin further to remove points that are closer than 20km.
However, note that the standard map units for a ‘lonlat’ projection are
meters. <code>tidysdm</code> provides a convening conversion function,
<code><a href="../reference/km2m.html">km2m()</a></code>, to avoid having to write lots of zeroes):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234567</span><span class="op">)</span></span>
<span><span class="va">lacerta_thin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_by_dist.html">thin_by_dist</a></span><span class="op">(</span><span class="va">lacerta</span>, dist_min <span class="op">=</span> <span class="fu"><a href="../reference/km2m.html">km2m</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lacerta_thin</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 111</span></span></code></pre></div>
<p>Let’s see what we have left of our points:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">land_mask</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">land_mask_1985</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_thin</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/plot_thin_by_dist-1.png" width="576"></p>
<p>We now need to select points that represent the potential available
area for the species. There are two approaches, we can either sample the
background with <code><a href="../reference/sample_background.html">sample_background()</a></code>, or we can generate
pseudo-absences with <code><a href="../reference/sample_pseudoabs.html">sample_pseudoabs()</a></code>. In this example,
we will sample the background; more specifically, we will attempt to
account for potential sampling biases by using a target group approach,
where presences from other species within the same taxonomic group are
used to condition the sampling of the background, providing information
on differential sampling of different areas within the region of
interest.</p>
<p>We will start by downloading records from 8 genera of
<em>Lacertidae</em>, covering the same geographic region of the Iberian
peninsula from GBIF <a href="https://doi.org/10.15468/dl.53js5z" class="external-link uri">https://doi.org/10.15468/dl.53js5z</a>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># download presences</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/rgbif" class="external-link">rgbif</a></span><span class="op">)</span></span>
<span><span class="co"># download file</span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/rgbif/reference/occ_download_get.html" class="external-link">occ_download_get</a></span><span class="op">(</span>key <span class="op">=</span> <span class="st">"0121761-240321170329656"</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># read file</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span><span class="va">backg_distrib</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu">read_delim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"0121761-240321170329656.zip"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># keep the necessary columns</span></span>
<span><span class="va">lacertidae_background</span> <span class="op">&lt;-</span> <span class="va">backg_distrib</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">gbifID</span>, <span class="va">decimalLatitude</span>, <span class="va">decimalLongitude</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>ID <span class="op">=</span> <span class="va">gbifID</span>, latitude <span class="op">=</span> <span class="va">decimalLatitude</span>, longitude <span class="op">=</span> <span class="va">decimalLongitude</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lacertidae_background</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">lacertidae_background</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">lacertidae_background</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">4326</span></span></code></pre></div>
<p>We need to convert these observations into a raster whose values are
the number of records (which will be later used to determine how likely
each cell is to be used as a background point):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacertidae_background_raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/rasterize.html" class="external-link">rasterize</a></span><span class="op">(</span><span class="va">lacertidae_background</span>, <span class="va">land_mask</span>, fun <span class="op">=</span> <span class="st">"count"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lacertidae_background_raster</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/background_to_raster-1.png" width="700"></p>
<p>We can see that the sampling is far from random, with certain
locations having very large number of records. We can now sample the
background, using the ‘bias’ method to represent this heterogeneity in
sampling effort:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234567</span><span class="op">)</span></span>
<span><span class="va">lacerta_thin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_background.html">sample_background</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_thin</span>, raster <span class="op">=</span> <span class="va">lacertidae_background_raster</span>,</span>
<span>                  n <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lacerta_thin</span><span class="op">)</span>,</span>
<span>                  method <span class="op">=</span> <span class="st">"bias"</span>,</span>
<span>                  class_label <span class="op">=</span> <span class="st">"background"</span>,</span>
<span>                  return_pres <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Let’s see our presences and background:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">land_mask</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">land_mask_1985</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_thin</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">class</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/plot_sample_pseudoabs-1.png" width="576"></p>
<p>Generally, we can use <code>pastclim</code> to check what variables
are available for the WorldClim dataset:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">climate_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/get_vars_for_dataset.html" class="external-link">get_vars_for_dataset</a></span><span class="op">(</span><span class="st">"WorldClim_2.1_10m"</span><span class="op">)</span></span></code></pre></div>
<p>We first download the dataset at the right resolution (here 10
arc-minutes):</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/download_dataset.html" class="external-link">download_dataset</a></span><span class="op">(</span><span class="st">"WorldClim_2.1_10m"</span><span class="op">)</span></span></code></pre></div>
<p>And then create a <code>terra</code> <code>SpatRaster</code> object.
The dataset covers the period 1970-2000, so <code>pastclim</code> dates
it as 1985 (the midpoint). We can directly crop to the Iberian
peninsula:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">climate_present</span> <span class="op">&lt;-</span> <span class="fu">pastclim</span><span class="fu">::</span><span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/region_slice.html" class="external-link">region_slice</a></span><span class="op">(</span></span>
<span>  time_ce <span class="op">=</span> <span class="fl">1985</span>,</span>
<span>  bio_variables <span class="op">=</span> <span class="va">climate_vars</span>,</span>
<span>  data <span class="op">=</span> <span class="st">"WorldClim_2.1_10m"</span>,</span>
<span>  crop <span class="op">=</span> <span class="va">iberia_poly</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Next, we extract climate for all presences and background points:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_thin</span> <span class="op">&lt;-</span> <span class="va">lacerta_thin</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">climate_present</span>, <span class="va">lacerta_thin</span>, ID <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Based on this paper (<a href="https://doi.org/10.1007/s10531-010-9865-2" class="external-link uri">https://doi.org/10.1007/s10531-010-9865-2</a>), we are
interested in these variables: “bio06”, “bio05”, “bio13”, “bio14”,
“bio15”. We can visualise the differences between presences and the
background using violin plots:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_thin</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/plot_pres_vs_bg.html">plot_pres_vs_bg</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-8-1.png" width="672">
We can see that all the variables of interest do seem to have a
different distribution between presences and the background. We can
formally quantify the mismatch between the two by computing the
overlap:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_thin</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/dist_pres_vs_bg.html">dist_pres_vs_bg</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span></span>
<span><span class="co">#&gt;      bio09      bio12      bio16      bio13      bio05      bio10      bio19 </span></span>
<span><span class="co">#&gt; 0.44341125 0.43673315 0.42163656 0.41676947 0.41107299 0.40554870 0.40009102 </span></span>
<span><span class="co">#&gt;      bio02      bio07      bio04      bio08      bio17      bio18      bio14 </span></span>
<span><span class="co">#&gt; 0.36398134 0.34354633 0.31492272 0.30408833 0.30393285 0.27604384 0.26619609 </span></span>
<span><span class="co">#&gt;      bio01      bio15      bio03      bio11   altitude      bio06 </span></span>
<span><span class="co">#&gt; 0.26516698 0.24779818 0.15863624 0.10530412 0.09195507 0.04780224</span></span></code></pre></div>
<p>Again, we can see that the variables of interest seem good candidates
with a clear signal. Let us then focus on those variables:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">suggested_vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bio06"</span>, <span class="st">"bio05"</span>, <span class="st">"bio13"</span>, <span class="st">"bio14"</span>, <span class="st">"bio15"</span><span class="op">)</span></span></code></pre></div>
<p>Environmental variables are often highly correlated, and collinearity
is an issue for several types of models. We can inspect the correlation
among variables with:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rspatial.github.io/terra/reference/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">climate_present</span><span class="op">[[</span><span class="va">suggested_vars</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>We can see that some variables have rather high correlation
(e.g. bio05 vs bio14). We can subset to variables below a certain
threshold correlation (e.g. 0.7) with:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">climate_present</span> <span class="op">&lt;-</span> <span class="va">climate_present</span><span class="op">[[</span><span class="va">suggested_vars</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="va">vars_uncor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_collinear.html">filter_collinear</a></span><span class="op">(</span><span class="va">climate_present</span>, cutoff <span class="op">=</span> <span class="fl">0.7</span>, method <span class="op">=</span> <span class="st">"cor_caret"</span><span class="op">)</span></span>
<span><span class="va">vars_uncor</span></span>
<span><span class="co">#&gt; [1] "bio15" "bio05" "bio13" "bio06"</span></span>
<span><span class="co">#&gt; attr(,"to_remove")</span></span>
<span><span class="co">#&gt; [1] "bio14"</span></span></code></pre></div>
<p>So, removing bio14 leaves us with a set of uncorrelated variables.
Note that <code>filter_collinear</code> has other methods based on
variable inflation that would also be worth exploring. For this example,
we will remove bio14 and work with the remaining variables.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_thin</span> <span class="op">&lt;-</span> <span class="va">lacerta_thin</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">vars_uncor</span>, <span class="st">"class"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">climate_present</span> <span class="op">&lt;-</span> <span class="va">climate_present</span><span class="op">[[</span><span class="va">vars_uncor</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">climate_present</span><span class="op">)</span> <span class="co"># added to highlight which variables are retained in the end</span></span>
<span><span class="co">#&gt; [1] "bio15" "bio05" "bio13" "bio06"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit-the-model-by-cross-validation">Fit the model by cross-validation<a class="anchor" aria-label="anchor" href="#fit-the-model-by-cross-validation"></a>
</h2>
<p>Next, we need to set up a <code>recipe</code> to define how to handle
our dataset. We don’t want to do anything to our data in terms of
transformations, so we just need to define the formula (<em>class</em>
is the <code>outcome</code>, all other variables are
<code>predictors</code>; note that, for <code>sf</code> objects,
<code>geometry</code> is automatically replaced by <code>X</code> and
<code>Y</code> columns which are assigned a role of <code>coords</code>,
and thus not used as predictors):</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_rec</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">lacerta_thin</span>, formula <span class="op">=</span> <span class="va">class</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span>
<span><span class="va">lacerta_rec</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Recipe</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Inputs</span></span>
<span><span class="co">#&gt; Number of variables by role</span></span>
<span><span class="co">#&gt; outcome:   1</span></span>
<span><span class="co">#&gt; predictor: 4</span></span>
<span><span class="co">#&gt; coords:    2</span></span></code></pre></div>
<p>In classification models for <code>tidymodels</code>, the assumption
is that the level of interest for the response (in our case, presences)
is the reference level. We can confirm that we have the data correctly
formatted with:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_thin</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/check_sdm_presence.html">check_sdm_presence</a></span><span class="op">(</span><span class="va">class</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>We now build a <code>workflow_set</code> of different models,
defining which hyperparameters we want to tune. We will use
<em>glm</em>, <em>random forest</em>, <em>boosted_trees</em> and
<em>maxent</em> as our models (for more details on how to use
<code>workflow_set</code>s, see <a href="https://workflowsets.tidymodels.org/articles/tuning-and-comparing-models.html" class="external-link">this
tutorial</a>). The latter three models have tunable hyperparameters. For
the most commonly used models, <code>tidysdm</code> automatically
chooses the most important parameters, but it is possible to fully
customise model specifications (e.g. see the help for
<code>sdm_spec_rf</code>).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_models</span> <span class="op">&lt;-</span></span>
<span>  <span class="co"># create the workflow_set</span></span>
<span>  <span class="fu">workflow_set</span><span class="op">(</span></span>
<span>    preproc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>default <span class="op">=</span> <span class="va">lacerta_rec</span><span class="op">)</span>,</span>
<span>    models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      <span class="co"># the standard glm specs</span></span>
<span>      glm <span class="op">=</span> <span class="fu"><a href="../reference/sdm_spec_glm.html">sdm_spec_glm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="co"># rf specs with tuning</span></span>
<span>      rf <span class="op">=</span> <span class="fu"><a href="../reference/sdm_spec_rand_forest.html">sdm_spec_rf</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="co"># boosted tree model (gbm) specs with tuning</span></span>
<span>      gbm <span class="op">=</span> <span class="fu"><a href="../reference/sdm_spec_boost_tree.html">sdm_spec_boost_tree</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      <span class="co"># maxent specs with tuning</span></span>
<span>      maxent <span class="op">=</span> <span class="fu"><a href="../reference/sdm_spec_maxent.html">sdm_spec_maxent</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="co"># make all combinations of preproc and models,</span></span>
<span>    cross <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># tweak controls to store information needed later to create the ensemble</span></span>
<span>  <span class="fu">option_add</span><span class="op">(</span>control <span class="op">=</span> <span class="fu"><a href="../reference/control_ensemble.html">control_ensemble_grid</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We now want to set up a spatial block cross-validation scheme to tune
and assess our models. We will split the data by creating 3 folds. We
use the <code>spatial_block_cv</code> function from the package
<code>spatialsample</code>. <code>spatialsample</code> offers a number
of sampling approaches for spatial data; it is also possible to convert
objects created with <code>blockCV</code> (which offers further features
for spatial sampling, such as stratified sampling) into an
<code>rsample</code> object suitable to <code>tisysdm</code> with the
function <code>blockcv2rsample</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EvolEcolGroup/tidysdm" class="external-link">tidysdm</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="co">#lacerta_cv &lt;- spatial_block_cv(lacerta_thin, v = 5)</span></span>
<span></span>
<span><span class="va">lacerta_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://spatialsample.tidymodels.org/reference/spatial_block_cv.html" class="external-link">spatial_block_cv</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_thin</span>, v <span class="op">=</span> <span class="fl">3</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">lacerta_cv</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/training_cv-1.png" width="576"></p>
<p>We can now use the block CV folds to tune and assess the models (to
keep computations fast, we will only explore 3 combination of
hyperparameters per model; this is far too little in real life!):</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234567</span><span class="op">)</span></span>
<span><span class="va">lacerta_models</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">lacerta_models</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">workflow_map</span><span class="op">(</span><span class="st">"tune_grid"</span>,</span>
<span>    resamples <span class="op">=</span> <span class="va">lacerta_cv</span>, grid <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    metrics <span class="op">=</span> <span class="fu"><a href="../reference/sdm_metric_set.html">sdm_metric_set</a></span><span class="op">(</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span>  <span style="color: #000000;">No tuning parameters. `fit_resamples()` will be attempted</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">1 of 4 resampling: default_glm</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">1 of 4 resampling: default_glm (188ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">2 of 4 tuning:     default_rf</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">Creating pre-processing data to finalize unknown parameter: mtry</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">2 of 4 tuning:     default_rf (808ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">3 of 4 tuning:     default_gbm</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">Creating pre-processing data to finalize unknown parameter: mtry</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">3 of 4 tuning:     default_gbm (3.9s)</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">4 of 4 tuning:     default_maxent</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">4 of 4 tuning:     default_maxent (1.2s)</span></span></span></code></pre></div>
<p>Note that <code>workflow_set</code> correctly detects that we have no
tuning parameters for <em>glm</em>. We can have a look at the
performance of our models with:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">lacerta_models</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/autoplot_models-1.png" width="672"></p>
<p>Now let’s create an ensemble, selecting the best set of parameters
for each model (this is really only relevant for the random forest, as
there were not hype-parameters to tune for the <em>glm</em> and
<em>gam</em>). We will use the Boyce continuous index as our metric to
choose the best random forest and boosted tree. When adding members to
an ensemble, they are automatically fitted to the full training dataset,
and so ready to make predictions.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_ensemble</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simple_ensemble.html">simple_ensemble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_member.html">add_member</a></span><span class="op">(</span><span class="va">lacerta_models</span>, metric <span class="op">=</span> <span class="st">"boyce_cont"</span><span class="op">)</span></span>
<span><span class="va">lacerta_ensemble</span></span>
<span><span class="co">#&gt; A simple_ensemble of models</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Members:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> default_glm</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> default_rf</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> default_gbm</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> default_maxent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Available metrics:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> boyce_cont</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> roc_auc</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> tss_max</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metric used to tune workflows:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> boyce_cont</span></span></code></pre></div>
<p>And visualise it</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">lacerta_ensemble</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/autoplot_ens-1.png" width="672"></p>
<p>A tabular form of the model metrics can be obtained with:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_ensemble</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu">collect_metrics</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 5</span></span></span>
<span><span class="co">#&gt;    wflow_id       .metric     mean std_err     n</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> default_glm    boyce_cont 0.547 0.127       3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> default_glm    roc_auc    0.773 0.034<span style="text-decoration: underline;">9</span>      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> default_glm    tss_max    0.507 0.043<span style="text-decoration: underline;">0</span>      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> default_rf     boyce_cont 0.722 0.098<span style="text-decoration: underline;">9</span>      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> default_rf     roc_auc    0.771 0.009<span style="text-decoration: underline;">88</span>     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> default_rf     tss_max    0.472 0.046<span style="text-decoration: underline;">7</span>      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> default_gbm    boyce_cont 0.661 0.129       3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> default_gbm    roc_auc    0.788 0.002<span style="text-decoration: underline;">24</span>     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> default_gbm    tss_max    0.514 0.013<span style="text-decoration: underline;">5</span>      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> default_maxent boyce_cont 0.751 0.101       3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> default_maxent roc_auc    0.798 0.019<span style="text-decoration: underline;">8</span>      3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> default_maxent tss_max    0.554 0.018<span style="text-decoration: underline;">6</span>      3</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="projecting-to-the-present">Projecting to the present<a class="anchor" aria-label="anchor" href="#projecting-to-the-present"></a>
</h2>
<p>We can now make predictions with this ensemble (using the default
option of taking the mean of the predictions from each model).</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prediction_present</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_raster.html">predict_raster</a></span><span class="op">(</span><span class="va">lacerta_ensemble</span>, <span class="va">climate_present</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prediction_present</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/scale_terrain.html" class="external-link">scale_fill_terrain_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># plot presences used in the model</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_thin</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"presence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/plot_present-1.png" width="576"></p>
<p>We can subset the ensemble to only use the best models, based on the
Boyce continuous index, by setting a minimum threshold of 0.7 for that
metric. We will also take the median of the available model predictions
(instead of the mean, which is the default). The plot does not change
much (the models are quite consistent).</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">prediction_present_boyce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_raster.html">predict_raster</a></span><span class="op">(</span><span class="va">lacerta_ensemble</span>, <span class="va">climate_present</span>,</span>
<span>  metric_thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"boyce_cont"</span>, <span class="fl">0.7</span><span class="op">)</span>,</span>
<span>  fun <span class="op">=</span> <span class="st">"median"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prediction_present_boyce</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">median</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/scale_terrain.html" class="external-link">scale_fill_terrain_c</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_thin</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"presence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/plot_present_best-1.png" width="576"></p>
<p>Sometimes, it is desirable to have binary predictions (presence vs
absence), rather than the probability of occurrence. To do so, we first
need to calibrate the threshold used to convert probabilities into
classes (in this case, we optimise the TSS):</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_ensemble</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calib_class_thresh.html">calib_class_thresh</a></span><span class="op">(</span><span class="va">lacerta_ensemble</span>,</span>
<span>  class_thresh <span class="op">=</span> <span class="st">"tss_max"</span>, </span>
<span>  metric_thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"boyce_cont"</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>And now we can predict for the whole continent:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prediction_present_binary</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_raster.html">predict_raster</a></span><span class="op">(</span><span class="va">lacerta_ensemble</span>,</span>
<span>  <span class="va">climate_present</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"class"</span>,</span>
<span>  class_thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tss_max"</span><span class="op">)</span>, </span>
<span>  metric_thresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"boyce_cont"</span>, <span class="fl">0.7</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prediction_present_binary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">binary_mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_thin</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">class</span> <span class="op">==</span> <span class="st">"presence"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="projecting-to-the-future">Projecting to the future<a class="anchor" aria-label="anchor" href="#projecting-to-the-future"></a>
</h2>
<p>WorldClim has a wide selection of projections for the future based on
different models and Shared Socio-economic Pathways (SSP). Type
<code><a href="https://evolecolgroup.github.io/pastclim/reference/WorldClim_2.1.html" class="external-link">help("WorldClim_2.1")</a></code> for a full list. We will use
predictions based on “HadGEM3-GC31-LL” model for SSP 245 (intermediate
green house gas emissions) at the same resolution as the present day
data (10 arc-minutes). We first download the data:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/download_dataset.html" class="external-link">download_dataset</a></span><span class="op">(</span><span class="st">"WorldClim_2.1_HadGEM3-GC31-LL_ssp245_10m"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s see what times are available:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/get_time_bp_steps.html" class="external-link">get_time_ce_steps</a></span><span class="op">(</span><span class="st">"WorldClim_2.1_HadGEM3-GC31-LL_ssp245_10m"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; [1] 2030 2050 2070 2090</span></span></code></pre>
<p>We will predict for 2090, the further prediction in the future that
is available.</p>
<p>Let’s now check the available variables:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/get_vars_for_dataset.html" class="external-link">get_vars_for_dataset</a></span><span class="op">(</span><span class="st">"WorldClim_2.1_HadGEM3-GC31-LL_ssp245_10m"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;  [1] "bio01" "bio02" "bio03" "bio04" "bio05" "bio06" "bio07" "bio08" "bio09"</span></span>
<span><span class="co">#&gt; [10] "bio10" "bio11" "bio12" "bio13" "bio14" "bio15" "bio16" "bio17" "bio18"</span></span>
<span><span class="co">#&gt; [19] "bio19"</span></span></code></pre>
<p>Note that future predictions do not include <em>altitude</em> (as
that does not change with time), so if we needed it, we would have to
copy it over from the present. However, it is not in our set of
uncorrelated variables that we used earlier, so we don’t need to worry
about it.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">climate_future</span> <span class="op">&lt;-</span> <span class="fu">pastclim</span><span class="fu">::</span><span class="fu"><a href="https://evolecolgroup.github.io/pastclim/reference/region_slice.html" class="external-link">region_slice</a></span><span class="op">(</span></span>
<span>  time_ce <span class="op">=</span> <span class="fl">2090</span>,</span>
<span>  bio_variables <span class="op">=</span> <span class="va">vars_uncor</span>,</span>
<span>  data <span class="op">=</span> <span class="st">"WorldClim_2.1_HadGEM3-GC31-LL_ssp245_10m"</span>,</span>
<span>  crop <span class="op">=</span> <span class="va">iberia_poly</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>And predict using the ensemble:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prediction_future</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_raster.html">predict_raster</a></span><span class="op">(</span><span class="va">lacerta_ensemble</span>, <span class="va">climate_future</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prediction_future</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/scale_terrain.html" class="external-link">scale_fill_terrain_c</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/plot_future-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="dealing-with-extrapolation">Dealing with extrapolation<a class="anchor" aria-label="anchor" href="#dealing-with-extrapolation"></a>
</h2>
<p>The total area of projection of the model may include environmental
conditions which lie outside the range of conditions covered by the
calibration dataset. This phenomenon can lead to misinterpretation of
the SDM outcomes due to spatial extrapolation.</p>
<p><code>tidysdm</code> offers a couple of approaches to deal with this
problem. The simplest one is that we can clamp the environmental
variables to stay within the limits observed in the calibration set:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">climate_future_clamped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clamp_predictors.html">clamp_predictors</a></span><span class="op">(</span><span class="va">climate_future</span>, </span>
<span>                                           training <span class="op">=</span> <span class="va">lacerta_thin</span>,</span>
<span>                                           .col<span class="op">=</span> <span class="va">class</span><span class="op">)</span></span>
<span><span class="va">prediction_future_clamped</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_raster.html">predict_raster</a></span><span class="op">(</span><span class="va">lacerta_ensemble</span>, </span>
<span>                                            raster <span class="op">=</span> <span class="va">climate_future_clamped</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prediction_future_clamped</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">mean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/scale_terrain.html" class="external-link">scale_fill_terrain_c</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>The predictions seem to have changed very little.</p>
<p>An alternative is to allow values to exceed the ranges of the
calibration set, but compute the Multivariate environmental similarity
surfaces (MESS) (Elith et al. 2010) to highlight areas where
extrapolation occurs and thus visualise the prediction’s
uncertainty.</p>
<p>We estimate the MESS for the same future time slice used above:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_mess_future</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extrapol_mess.html">extrapol_mess</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">climate_future</span>, </span>
<span>                                      training <span class="op">=</span> <span class="va">lacerta_thin</span>, </span>
<span>                                      .col <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_mess_future</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_b</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-25-1.png" width="700"></p>
<p>Extrapolation occurs in areas where MESS values are negative, with
the magnitude of the negative values indicating how extreme is in the
interpolation. From this plot, we can see that the area of extrapolation
is where the model already predicted a suitability of zero. This
explains why clamping did little to our predictions.</p>
<p>We can now overlay MESS values with current prediction to visualize
areas characterized by spatial extrapolation.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset mess </span></span>
<span><span class="va">lacerta_mess_future_subset</span> <span class="op">&lt;-</span> <span class="va">lacerta_mess_future</span></span>
<span><span class="va">lacerta_mess_future_subset</span><span class="op">[</span><span class="va">lacerta_mess_future_subset</span> <span class="op">&gt;=</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">lacerta_mess_future_subset</span><span class="op">[</span><span class="va">lacerta_mess_future_subset</span> <span class="op">&lt;</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># convert into polygon</span></span>
<span><span class="va">lacerta_mess_future_subset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/as.polygons.html" class="external-link">as.polygons</a></span><span class="op">(</span><span class="va">lacerta_mess_future_subset</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot as a mask </span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">prediction_future</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_b</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"transparent"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_mess_future_subset</span>, fill<span class="op">=</span> <span class="st">"lightgray"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-26-1.png" width="700"></p>
<p>Note that clamping and MESS are not only useful when making
predictions into the future, but also into the past and present (in the
latter case, it allows us to make sure that the
background/pseudoabsences do cover the full range of predictor variables
over the area of interest).</p>
<p>The <code>tidymodels</code> universe also includes functions to
estimate the area of applicability in the package <code>waywiser</code>,
which can be used with <code>tidysdm</code>.</p>
</div>
<div class="section level2">
<h2 id="visualising-the-contribution-of-individual-variables">Visualising the contribution of individual variables<a class="anchor" aria-label="anchor" href="#visualising-the-contribution-of-individual-variables"></a>
</h2>
<p>It is sometimes of interest to understand the relative contribution
of individual variables to the prediction. This is a complex task,
especially if there are interactions among variables. For simpler linear
models, it is possible to obtain marginal response curves (which show
the effect of a variable whilst keeping all other variables to their
mean) using <code>step_profile()</code> from the <code>recipes</code>
package. We use <code>step_profile()</code> to define a new recipe which
we can then bake to generate the appropriate dataset to make the
marginal prediction. We can then plot the predictions against the values
of the variable of interest. For example, to investigate the
contribution of <code>bio05</code>, we would:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bio05_prof</span> <span class="op">&lt;-</span> <span class="va">lacerta_rec</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">step_profile</span><span class="op">(</span><span class="op">-</span><span class="va">bio05</span>, profile <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">bio05</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">prep</span><span class="op">(</span>training <span class="op">=</span> <span class="va">lacerta_thin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bio05_data</span> <span class="op">&lt;-</span> <span class="fu">bake</span><span class="op">(</span><span class="va">bio05_prof</span>, new_data <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bio05_data</span> <span class="op">&lt;-</span> <span class="va">bio05_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    pred <span class="op">=</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">lacerta_ensemble</span>, <span class="va">bio05_data</span><span class="op">)</span><span class="op">$</span><span class="va">mean</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bio05_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">bio05</span>, y <span class="op">=</span> <span class="va">pred</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.5</span>, cex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<p>It is also possible to use <a href="https://modeloriented.github.io/DALEX/" class="external-link">DALEX</a>,to explore
<code>tidysdm</code> models; see more details in the <a href="https://evolecolgroup.github.io/tidysdm/dev/articles/a2_tidymodels_additions.html">tidymodels
additions</a> article.</p>
</div>
<div class="section level2">
<h2 id="repeated-ensembles">Repeated ensembles<a class="anchor" aria-label="anchor" href="#repeated-ensembles"></a>
</h2>
<p>The steps of thinning and sampling pseudo-absences can have a bit
impact on the performance of SDMs. As these steps are stochastic, it is
good practice to explore their effect by repeating them, and then
creating ensembles of models over these repeats. In
<code>tidysdm</code>, it is possible to create
<code>repeat_ensembles</code>. We start by creating a list of
<code>simple_ensembles</code>, by looping through the SDM pipeline. We
will just use two fast models to speed up the process.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># empty object to store the simple ensembles that we will create</span></span>
<span><span class="va">ensemble_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> <span class="co"># make sure you set the seed OUTSIDE the loop</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i_repeat</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># thin the data</span></span>
<span>  <span class="va">lacerta_thin_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_by_cell.html">thin_by_cell</a></span><span class="op">(</span><span class="va">lacerta</span>, raster <span class="op">=</span> <span class="va">climate_present</span><span class="op">)</span></span>
<span>  <span class="va">lacerta_thin_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/thin_by_dist.html">thin_by_dist</a></span><span class="op">(</span><span class="va">lacerta_thin_rep</span>, dist_min <span class="op">=</span> <span class="fl">20000</span><span class="op">)</span></span>
<span>  <span class="co"># sample pseudo-absences</span></span>
<span>  <span class="va">lacerta_thin_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_pseudoabs.html">sample_pseudoabs</a></span><span class="op">(</span><span class="va">lacerta_thin_rep</span>,</span>
<span>    n <span class="op">=</span> <span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">lacerta_thin_rep</span><span class="op">)</span>,</span>
<span>    raster <span class="op">=</span> <span class="va">climate_present</span>,</span>
<span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dist_min"</span>, <span class="fl">50000</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="co"># get climate</span></span>
<span>  <span class="va">lacerta_thin_rep</span> <span class="op">&lt;-</span> <span class="va">lacerta_thin_rep</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">climate_present</span>, <span class="va">lacerta_thin_rep</span>, ID <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co"># create folds</span></span>
<span>  <span class="va">lacerta_thin_rep_cv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://spatialsample.tidymodels.org/reference/spatial_block_cv.html" class="external-link">spatial_block_cv</a></span><span class="op">(</span><span class="va">lacerta_thin_rep</span>, v <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="co"># create a recipe</span></span>
<span>  <span class="va">lacerta_thin_rep_rec</span> <span class="op">&lt;-</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">lacerta_thin_rep</span>, formula <span class="op">=</span> <span class="va">class</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span></span>
<span>  <span class="co"># create a workflow_set</span></span>
<span>  <span class="va">lacerta_thin_rep_models</span> <span class="op">&lt;-</span></span>
<span>    <span class="co"># create the workflow_set</span></span>
<span>    <span class="fu">workflow_set</span><span class="op">(</span></span>
<span>      preproc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>default <span class="op">=</span> <span class="va">lacerta_thin_rep_rec</span><span class="op">)</span>,</span>
<span>      models <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        <span class="co"># the standard glm specs</span></span>
<span>        glm <span class="op">=</span> <span class="fu"><a href="../reference/sdm_spec_glm.html">sdm_spec_glm</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        <span class="co"># maxent specs with tuning</span></span>
<span>        maxent <span class="op">=</span> <span class="fu"><a href="../reference/sdm_spec_maxent.html">sdm_spec_maxent</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">)</span>,</span>
<span>      <span class="co"># make all combinations of preproc and models,</span></span>
<span>      cross <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="co"># tweak controls to store information needed later to create the ensemble</span></span>
<span>    <span class="fu">option_add</span><span class="op">(</span>control <span class="op">=</span> <span class="fu"><a href="../reference/control_ensemble.html">control_ensemble_grid</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># train the model</span></span>
<span>  <span class="va">lacerta_thin_rep_models</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">lacerta_thin_rep_models</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu">workflow_map</span><span class="op">(</span><span class="st">"tune_grid"</span>,</span>
<span>      resamples <span class="op">=</span> <span class="va">lacerta_thin_rep_cv</span>, grid <span class="op">=</span> <span class="fl">10</span>,</span>
<span>      metrics <span class="op">=</span> <span class="fu"><a href="../reference/sdm_metric_set.html">sdm_metric_set</a></span><span class="op">(</span><span class="op">)</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="co"># make an simple ensemble and add it to the list</span></span>
<span>  <span class="va">ensemble_list</span><span class="op">[[</span><span class="va">i_repeat</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simple_ensemble.html">simple_ensemble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/add_member.html">add_member</a></span><span class="op">(</span><span class="va">lacerta_thin_rep_models</span>, metric <span class="op">=</span> <span class="st">"boyce_cont"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span>  <span style="color: #000000;">No tuning parameters. `fit_resamples()` will be attempted</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">1 of 2 resampling: default_glm</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">1 of 2 resampling: default_glm (225ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">2 of 2 tuning:     default_maxent</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">2 of 2 tuning:     default_maxent (7s)</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span>  <span style="color: #000000;">No tuning parameters. `fit_resamples()` will be attempted</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">1 of 2 resampling: default_glm</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">1 of 2 resampling: default_glm (219ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">2 of 2 tuning:     default_maxent</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">2 of 2 tuning:     default_maxent (6.8s)</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span>  <span style="color: #000000;">No tuning parameters. `fit_resamples()` will be attempted</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">1 of 2 resampling: default_glm</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">1 of 2 resampling: default_glm (221ms)</span></span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">i</span> <span style="color: #000000;">2 of 2 tuning:     default_maxent</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #000000;">2 of 2 tuning:     default_maxent (7.2s)</span></span></span></code></pre></div>
<p>Now we can create a <code>repeat_ensemble</code> from the list:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_rep_ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/repeat_ensemble.html">repeat_ensemble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/add_repeat.html">add_repeat</a></span><span class="op">(</span><span class="va">ensemble_list</span><span class="op">)</span></span>
<span><span class="va">lacerta_rep_ens</span></span>
<span><span class="co">#&gt; A repeat_ensemble of models</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of repeats:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Members:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> default_glm</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> default_maxent</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Available metrics:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> boyce_cont</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> roc_auc</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> tss_max</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Metric used to tune workflows:</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">•</span> boyce_cont</span></span></code></pre></div>
<p>We can summarise the goodness of fit of models for each repeat with
<code>collect_metrics()</code>, but there is no <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot()</a></code>
function for <code>repeated_ensemble</code> objects.</p>
<p>We can then predict in the usual way (we will take the mean and
median of all models):</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lacerta_rep_ens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_raster.html">predict_raster</a></span><span class="op">(</span><span class="va">lacerta_rep_ens</span>, <span class="va">climate_present</span>,</span>
<span>  fun <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">lacerta_rep_ens</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">median</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/scale_terrain.html" class="external-link">scale_fill_terrain_c</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="a0_tidysdm_overview_files/figure-html/unnamed-chunk-30-1.png" width="576"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michela Leonardi, Margherita Colucci, Andrea Pozzi, Andrea Manica.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
